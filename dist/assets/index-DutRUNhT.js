import{r as _,a as He,R as Oe}from"./vendor-wGySg1uH.js";import{c as Ve}from"./supabase-DfwcnzK-.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const b of l)if(b.type==="childList")for(const w of b.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&a(w)}).observe(document,{childList:!0,subtree:!0});function c(l){const b={};return l.integrity&&(b.integrity=l.integrity),l.referrerPolicy&&(b.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?b.credentials="include":l.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function a(l){if(l.ep)return;l.ep=!0;const b=c(l);fetch(l.href,b)}})();var De={exports:{}},se={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ze=_,Ye=Symbol.for("react.element"),Ge=Symbol.for("react.fragment"),Qe=Object.prototype.hasOwnProperty,Je=ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ze={key:!0,ref:!0,__self:!0,__source:!0};function $e(n,i,c){var a,l={},b=null,w=null;c!==void 0&&(b=""+c),i.key!==void 0&&(b=""+i.key),i.ref!==void 0&&(w=i.ref);for(a in i)Qe.call(i,a)&&!Ze.hasOwnProperty(a)&&(l[a]=i[a]);if(n&&n.defaultProps)for(a in i=n.defaultProps,i)l[a]===void 0&&(l[a]=i[a]);return{$$typeof:Ye,type:n,key:b,ref:w,props:l,_owner:Je.current}}se.Fragment=Ge;se.jsx=$e;se.jsxs=$e;De.exports=se;var e=De.exports,le={},_e=He;le.createRoot=_e.createRoot,le.hydrateRoot=_e.hydrateRoot;const Xe="https://jzvmlgahptwixtrleaco.supabase.co",Ke="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp6dm1sZ2FocHR3aXh0cmxlYWNvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4NTk5MzksImV4cCI6MjA4NDQzNTkzOX0.epNrqnRXT__ZlADFaZ3zIDSLtgdfNCPdN-oZYcay--w",$=Ve(Xe,Ke,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Re="bidsmart_user",et="demo@theswitchison.org",tt="Demo User";function rt(){if(typeof window>"u")return null;const n=new URLSearchParams(window.location.search),i=n.get("user_email"),c=n.get("user_name");return i?{email:i,name:c||i.split("@")[0]}:null}function st(){try{const n=localStorage.getItem(Re);if(n)return JSON.parse(n)}catch{}return null}function we(n){try{localStorage.setItem(Re,JSON.stringify(n))}catch{}}async function at(n,i){const{data:c,error:a}=await $.from("users_ext").select("*").eq("email",n).maybeSingle();if(a)throw console.error("Error fetching user:",a),a;if(c)return c;const{data:l,error:b}=await $.from("users_ext").insert({email:n,full_name:i}).select().single();if(b)throw console.error("Error creating user:",b),b;return l}function it(){const[n,i]=_.useState(null),[c,a]=_.useState(!0),[l,b]=_.useState(!1),[w,C]=_.useState(null);return _.useEffect(()=>{async function A(){try{const P=rt(),o=st();let N;P?(N=P,we(P)):o?N=o:(N={email:et,name:tt},we(N));const j=await at(N.email,N.name),y=j.created_at!==j.updated_at||new Date(j.created_at).getTime()<Date.now()-5e3;i(j),b(y)}catch(P){console.error("Error initializing user:",P),C(P instanceof Error?P:new Error("Failed to initialize user"))}finally{a(!1)}}A()},[]),{user:n,loading:c,isReturningUser:l,error:w}}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),I=(n,i)=>{const c=_.forwardRef(({color:a="currentColor",size:l=24,strokeWidth:b=2,absoluteStrokeWidth:w,className:C="",children:A,...P},o)=>_.createElement("svg",{ref:o,...nt,width:l,height:l,stroke:a,strokeWidth:w?Number(b)*24/Number(l):b,className:["lucide",`lucide-${ot(n)}`,C].join(" "),...P},[...i.map(([N,j])=>_.createElement(N,j)),...Array.isArray(A)?A:[A]]));return c.displayName=`${n}`,c};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=I("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=I("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=I("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=I("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=I("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=I("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=I("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=I("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=I("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=I("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=I("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=I("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=I("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=I("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=I("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=I("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=I("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=I("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=I("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=I("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=I("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=I("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=I("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=I("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=I("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=I("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=I("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=I("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=I("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=I("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=I("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=I("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=I("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=I("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=I("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=I("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=I("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);async function xe(n,i={}){const{data:c,error:a}=await $.from("projects").insert({user_id:n,project_name:i.project_name||"My Heat Pump Project",status:i.status||"draft",...i}).select().single();if(a)throw a;return c}async function Le(n){const{data:i,error:c}=await $.from("projects").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(c)throw c;return i||[]}async function kt(n){const{data:i,error:c}=await $.from("projects").select("*").eq("user_id",n).eq("project_name","Demo: Heat Pump Comparison").order("created_at",{ascending:!1}).limit(1).maybeSingle();if(c)throw c;return i}async function St(n,i){const{data:c,error:a}=await $.from("projects").update(i).eq("id",n).select().maybeSingle();if(a)throw a;return c}async function It(n,i){const c={data_sharing_consent:i};return i&&(c.data_sharing_consented_at=new Date().toISOString()),St(n,c)}async function Pt(n,i){const{data:c,error:a}=await $.from("contractor_bids").insert({project_id:n,contractor_name:i.contractor_name||"Unknown Contractor",total_bid_amount:i.total_bid_amount||0,extraction_confidence:i.extraction_confidence||"manual",financing_offered:i.financing_offered||!1,verified_by_user:i.verified_by_user||!1,is_favorite:i.is_favorite||!1,...i}).select().single();if(a)throw a;return c}async function ve(n){const{data:i,error:c}=await $.from("contractor_bids").select("*").eq("project_id",n).order("overall_score",{ascending:!1,nullsFirst:!1});if(c)throw c;return i||[]}async function Ce(n){const{data:i,error:c}=await $.from("bid_equipment").select("*").eq("bid_id",n);if(c)throw c;return i||[]}async function qt(n,i){const c=i.map(b=>({bid_id:n,equipment_type:b.equipment_type||"other",brand:b.brand||"Unknown",confidence:b.confidence||"manual",...b})),{data:a,error:l}=await $.from("bid_equipment").insert(c).select();if(l)throw l;return a||[]}async function ge(n){const{data:i,error:c}=await $.from("project_requirements").select("*").eq("project_id",n).maybeSingle();if(c)throw c;return i}async function At(n,i={}){const{data:c,error:a}=await $.from("project_requirements").insert({project_id:n,priority_price:i.priority_price??3,priority_warranty:i.priority_warranty??3,priority_efficiency:i.priority_efficiency??3,priority_timeline:i.priority_timeline??3,priority_reputation:i.priority_reputation??3,timeline_urgency:i.timeline_urgency??"flexible",specific_concerns:i.specific_concerns??[],must_have_features:i.must_have_features??[],nice_to_have_features:i.nice_to_have_features??[],...i}).select().single();if(a)throw a;return c}async function Dt(n,i){const{data:c,error:a}=await $.from("project_requirements").update({...i,updated_at:new Date().toISOString()}).eq("project_id",n).select().maybeSingle();if(a)throw a;return c}async function $t(n,i){if(await ge(n)){const a=await Dt(n,{...i,completed_at:new Date().toISOString()});if(!a)throw new Error("Failed to update requirements");return a}return At(n,{...i,completed_at:new Date().toISOString()})}const Rt=[{bid:{contractor_name:"Bay Area Heat Pump Pros",contractor_company:"Bay Area Heat Pump Pros LLC",contractor_phone:"(415) 555-1234",contractor_email:"info@baheatpumppros.com",contractor_license:"CSLB #1234567",contractor_license_state:"CA",contractor_website:"https://baheatpumppros.com",contractor_years_in_business:15,contractor_google_rating:4.8,contractor_google_review_count:247,contractor_certifications:["NATE Certified","EPA 608","Carrier Factory Authorized"],contractor_is_switch_preferred:!0,total_bid_amount:18500,labor_cost:4500,equipment_cost:9800,materials_cost:1200,permit_cost:850,total_before_rebates:18500,estimated_rebates:3500,total_after_rebates:15e3,estimated_days:2,labor_warranty_years:2,equipment_warranty_years:10,deposit_required:3700,deposit_percentage:20,financing_offered:!0,financing_terms:"0% APR for 24 months through GreenSky",scope_summary:"Complete heat pump system installation with panel upgrade",inclusions:["Remove existing gas furnace and AC","Install Carrier Infinity 26 heat pump","Install new air handler","Install Infinity Touch thermostat","200A electrical panel upgrade","Permits and inspections","System commissioning","Homeowner training"],exclusions:["Ductwork modifications","Drywall repair","Landscaping restoration"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Carrier",model_number:"25VNA836A003",model_name:"Infinity 26 Heat Pump",capacity_btu:36e3,capacity_tons:3,seer_rating:26,seer2_rating:24.5,hspf_rating:13,hspf2_rating:10.5,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:51,voltage:240,energy_star_certified:!0,energy_star_most_efficient:!0,equipment_cost:7200,confidence:"high"},{equipment_type:"indoor_unit",brand:"Carrier",model_number:"FV4CNB003",model_name:"Infinity Series Air Handler",variable_speed:!0,equipment_cost:2600,confidence:"high"}],questions:[{question_text:"What is the exact start date availability?",question_category:"timeline",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Is the 10-year warranty transferable to a new homeowner?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Will you perform a Manual J load calculation before installation?",question_category:"scope",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What happens if the 200A panel upgrade reveals additional electrical issues?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Can you provide references from recent heat pump installations?",question_category:"credentials",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What commissioning tests will you perform after installation?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"How does the 0% APR financing work and are there any hidden fees?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What is your process if the system does not perform as expected?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0}]},{bid:{contractor_name:"GreenTech HVAC Solutions",contractor_company:"GreenTech HVAC Solutions Inc",contractor_phone:"(510) 555-9876",contractor_email:"sales@greentechhvac.com",contractor_license:"CSLB #9876543",contractor_license_state:"CA",contractor_website:"https://greentechhvac.com",contractor_years_in_business:8,contractor_google_rating:4.6,contractor_google_review_count:156,contractor_certifications:["NATE Certified","EPA 608","Mitsubishi Diamond Contractor"],contractor_is_switch_preferred:!1,total_bid_amount:16800,labor_cost:3800,equipment_cost:9200,materials_cost:1e3,permit_cost:750,total_before_rebates:16800,estimated_rebates:3200,total_after_rebates:13600,estimated_days:3,labor_warranty_years:1,equipment_warranty_years:12,deposit_required:5040,deposit_percentage:30,financing_offered:!0,financing_terms:"5.99% APR for 60 months",scope_summary:"Heat pump installation with existing electrical panel",inclusions:["Remove existing HVAC system","Install Mitsubishi heat pump","Install air handler","Ecobee smart thermostat","Permits and inspections","System startup"],exclusions:["Electrical panel upgrade (additional $2,500)","Ductwork modifications","Drywall repair"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Mitsubishi",model_number:"SUZ-KA36NAHZ",model_name:"Hyper-Heating INVERTER",capacity_btu:36e3,capacity_tons:3,seer_rating:20,seer2_rating:18.5,hspf_rating:12.5,hspf2_rating:10.2,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:48,voltage:230,energy_star_certified:!0,energy_star_most_efficient:!1,equipment_cost:6800,confidence:"high"},{equipment_type:"indoor_unit",brand:"Mitsubishi",model_number:"SVZ-KP36NA",model_name:"Multi-Position Air Handler",variable_speed:!0,equipment_cost:2400,confidence:"high"}],questions:[{question_text:"Will the existing electrical panel support the heat pump?",question_category:"scope",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Why is the labor warranty only 1 year?",question_category:"warranty",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What is included in the electrical panel upgrade if needed ($2,500)?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Will you perform airflow measurements and duct testing?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is the cold weather performance of this Mitsubishi model?",question_category:"equipment",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Can you extend the labor warranty for an additional fee?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Why is the 30% deposit higher than typical?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What maintenance is required to keep the 12-year warranty valid?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Do you offer any post-installation support or maintenance plans?",question_category:"scope",priority:"low",is_answered:!1,auto_generated:!0}]},{bid:{contractor_name:"Comfort First Heating & Cooling",contractor_company:"Comfort First H&C",contractor_phone:"(408) 555-4321",contractor_email:"quotes@comfortfirst.com",contractor_license:"CSLB #5678901",contractor_license_state:"CA",contractor_years_in_business:22,contractor_google_rating:4.9,contractor_google_review_count:412,contractor_certifications:["NATE Certified","EPA 608","Lennox Premier Dealer","BPI Certified"],contractor_is_switch_preferred:!0,total_bid_amount:21500,labor_cost:5500,equipment_cost:11500,materials_cost:1500,permit_cost:950,total_before_rebates:21500,estimated_rebates:4e3,total_after_rebates:17500,estimated_days:2,labor_warranty_years:5,equipment_warranty_years:10,deposit_required:4300,deposit_percentage:20,financing_offered:!0,financing_terms:"0% APR for 36 months or 2.99% for 72 months",scope_summary:"Premium installation with load calculation and duct sealing",inclusions:["Manual J load calculation","Remove existing system","Install Lennox XP25 heat pump","Install air handler with ECM motor","iComfort S30 smart thermostat","Electrical circuit upgrade","Duct sealing and testing","Permits and inspections","Professional commissioning","First year maintenance included"],exclusions:["Full ductwork replacement","Drywall repair"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Lennox",model_number:"XP25-036-230",model_name:"XP25 Variable Capacity Heat Pump",capacity_btu:36e3,capacity_tons:3,seer_rating:25.5,seer2_rating:23.5,hspf_rating:11.5,hspf2_rating:9.8,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:59,voltage:230,energy_star_certified:!0,energy_star_most_efficient:!0,equipment_cost:8500,confidence:"high"},{equipment_type:"indoor_unit",brand:"Lennox",model_number:"CBX40UHV-036",model_name:"Variable Speed Air Handler",variable_speed:!0,equipment_cost:3e3,confidence:"high"}],questions:[{question_text:"What does the Manual J load calculation include?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is the justification for the higher price compared to other bids?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What does the 5-year labor warranty cover specifically?",question_category:"warranty",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What does the duct sealing and testing process involve?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is included in the first year maintenance?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"How does the XP25 compare to the Carrier Infinity 26 in cold weather?",question_category:"equipment",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What is the sound level of this equipment compared to my current system?",question_category:"equipment",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"Can you walk me through the professional commissioning process?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What happens after the first year of maintenance - what are ongoing costs?",question_category:"pricing",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Are there any additional rebates you can help me apply for?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0}]}],Et=[{program_name:"Federal 25C Tax Credit",program_code:"FED-25C",description:"Tax credit for energy efficient home improvements",program_type:"federal",available_nationwide:!0,rebate_percentage:30,max_rebate:2e3,income_qualified:!1,stackable:!0,is_active:!0},{program_name:"BayREN Home+ Rebate",program_code:"BAYREN-HP",description:"Bay Area regional heat pump rebate program",program_type:"utility",available_states:["CA"],rebate_amount:1500,income_qualified:!1,stackable:!0,is_active:!0}],ke=[{number:1,label:"GATHER",title:"Upload & Prioritize",description:"Upload contractor bids and set your priorities",icon:je,color:"bg-switch-green-100 text-switch-green-700"},{number:2,label:"COMPARE",title:"Analyze Options",description:"Compare equipment, costs, and contractors side-by-side",icon:dt,color:"bg-blue-100 text-blue-700"},{number:3,label:"DECIDE",title:"Make Your Choice",description:"Review incentives and select your contractor",icon:H,color:"bg-amber-100 text-amber-700"},{number:4,label:"VERIFY",title:"Quality Check",description:"Ensure proper installation with our checklist",icon:gt,color:"bg-purple-100 text-purple-700"}];function Mt({onStartProject:n,onStartDemo:i}){return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Your Bid Comparison Journey"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Follow these four simple steps to confidently choose the right heat pump contractor"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:ke.map((c,a)=>{const l=c.icon;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 h-full flex flex-col items-center text-center transition-all hover:shadow-md hover:bg-gray-100 cursor-default",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${c.color} flex items-center justify-center mb-3`,children:e.jsx(l,{className:"w-6 h-6"})}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"text-xs font-semibold text-gray-500 mb-1",children:["STEP ",c.number]}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:c.title})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:c.description})]}),a<ke.length-1&&e.jsx("div",{className:"hidden md:block absolute top-1/4 -right-2 w-4 h-4",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full text-gray-300",children:e.jsx("path",{d:"M9 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},c.number)})}),(n||i)&&e.jsx("div",{className:"text-center pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[n&&e.jsxs("button",{onClick:n,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-switch-green-600 text-white rounded-lg font-medium hover:bg-switch-green-700 transition-colors",children:[e.jsx(je,{className:"w-4 h-4"}),"Get Started with Your Bids"]}),i&&e.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-6 py-2.5 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:[e.jsx(_t,{className:"w-4 h-4"}),"Try Demo Mode"]})]})})]})}function Bt({user:n,onSelectProject:i,onCreateProject:c}){const[a,l]=_.useState([]),[b,w]=_.useState(!0);_.useEffect(()=>{C()},[n.id]);async function C(){try{const j=await Le(n.id);l(j)}catch(j){console.error("Failed to load projects:",j)}finally{w(!1)}}async function A(){try{const j=await xe(n.id,{project_name:"My Heat Pump Project",status:"collecting_bids"});c(j.id)}catch(j){console.error("Failed to create project:",j)}}async function P(){try{const j=await kt(n.id);if(j){c(j.id);return}const y=await xe(n.id,{project_name:"Demo: Heat Pump Comparison",status:"collecting_bids",heat_pump_type:"air_source",system_size_tons:3});await $.from("project_requirements").insert({project_id:y.id,priority_price:4,priority_warranty:3,priority_efficiency:4,priority_timeline:2,priority_reputation:5,timeline_urgency:"within_month",specific_concerns:["Energy efficiency","Long-term reliability"],must_have_features:["Variable speed compressor","Smart thermostat compatible"],nice_to_have_features:["Low noise operation"],completed_at:new Date().toISOString()});for(const d of Rt){const g=await Pt(y.id,d.bid);if(d.equipment.length>0&&await qt(g.id,d.equipment),d.questions.length>0){const k=d.questions.map((S,q)=>({bid_id:g.id,...S,display_order:q}));await $.from("bid_questions").insert(k)}}for(const d of Et){const{data:g}=await $.from("rebate_programs").select("id").eq("program_code",d.program_code).maybeSingle();g||await $.from("rebate_programs").insert(d)}c(y.id)}catch(j){console.error("Failed to create demo project:",j)}}function o(j){return new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function N(j){const y={draft:{label:"Draft",className:"bg-gray-100 text-gray-600"},collecting_bids:{label:"Gathering Bids",className:"bg-blue-100 text-blue-700"},analyzing:{label:"Analyzing",className:"bg-amber-100 text-amber-700"},comparing:{label:"Comparing",className:"bg-switch-green-100 text-switch-green-700"},decided:{label:"Decision Made",className:"bg-switch-green-100 text-switch-green-700"},completed:{label:"Completed",className:"bg-gray-100 text-gray-600"}},d=y[j]||y.draft;return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${d.className}`,children:d.label})}return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-switch-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading your projects..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome to BidSmart"}),e.jsx("p",{className:"text-gray-600",children:"Compare heat pump bids with confidence."}),n.email&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:n.email})]})]}),e.jsx(Mt,{onStartProject:A,onStartDemo:P}),a.length>0&&e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(pt,{className:"w-5 h-5 text-gray-400"}),"Your Projects"]}),e.jsx("div",{className:"space-y-3",children:a.map(j=>e.jsxs("button",{onClick:()=>i(j.id),className:"w-full bg-white rounded-xl border border-gray-200 p-4 flex items-center gap-4 hover:border-gray-300 hover:shadow-sm transition-all text-left group",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(de,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:j.project_name}),N(j.status)]}),e.jsx("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),o(j.created_at)]})})]}),e.jsx(ue,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]},j.id))})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsx("p",{className:"text-xs text-gray-400",children:"Powered by TheSwitchIsOn.org"})})]})})}const Tt={1:"GATHER",2:"COMPARE",3:"DECIDE",4:"VERIFY"},Fe=_.createContext(null),Ue="bidsmart_phase_state";function Wt(){try{const n=localStorage.getItem(Ue);if(n)return JSON.parse(n)}catch{}return null}function ce(n){try{localStorage.setItem(Ue,JSON.stringify(n))}catch{}}function Lt({children:n,userId:i,initialProjectId:c}){const[a,l]=_.useState({currentPhase:1,phaseStatus:{1:"active",2:"locked",3:"locked",4:"locked"},projectId:null,project:null,bids:[],requirements:null,questions:[],loading:!0,error:null});_.useEffect(()=>{async function y(){try{const d=Wt(),g=await Le(i);let k,S;if(c){const m=g.find(T=>T.id===c);if(m)k=c,S=m;else throw new Error("Project not found")}else d!=null&&d.projectId&&g.find(m=>m.id===d.projectId)?(k=d.projectId,S=g.find(m=>m.id===d.projectId)):g.length>0?(S=g[0],k=S.id):(S=await xe(i,{project_name:"My Heat Pump Project",status:"collecting_bids"}),k=S.id);const q=await ve(k),x=await Promise.all(q.map(async m=>({bid:m,equipment:await Ce(m.id)}))),f=await ge(k),{data:h}=await $.from("bid_questions").select("*").in("bid_id",q.map(m=>m.id)).order("display_order",{ascending:!0});let M=1,B={1:"active",2:"locked",3:"locked",4:"locked"};d&&d.projectId===k?(M=d.currentPhase,B=d.phaseStatus):x.length>=2&&(f!=null&&f.completed_at)&&(B[1]="completed",B[2]="active",B[3]="active",B[4]="active",M=2),l({currentPhase:M,phaseStatus:B,projectId:k,project:S,bids:x,requirements:f,questions:h||[],loading:!1,error:null}),ce({currentPhase:M,projectId:k,phaseStatus:B})}catch(d){console.error("Failed to initialize project:",d),l(g=>({...g,loading:!1,error:"Failed to load project data"}))}}y()},[i,c]);const b=_.useCallback(y=>a.phaseStatus[y]!=="locked",[a.phaseStatus]),w=_.useCallback(y=>{b(y)&&l(d=>{const g={...d,currentPhase:y};return ce({currentPhase:y,projectId:d.projectId,phaseStatus:d.phaseStatus}),g})},[b]),C=_.useCallback(y=>{l(d=>{const g={...d.phaseStatus};if(g[y]="completed",y===1)g[2]="active",g[3]="active",g[4]="active";else{const q=y+1;q<=4&&g[q]==="locked"&&(g[q]="active")}const k=y+1,S=k<=4?k:y;return ce({currentPhase:S,projectId:d.projectId,phaseStatus:g}),{...d,currentPhase:S,phaseStatus:g}})},[]),A=_.useCallback(async()=>{if(!a.projectId)return;const y=await ve(a.projectId),d=await Promise.all(y.map(async g=>({bid:g,equipment:await Ce(g.id)})));l(g=>({...g,bids:d}))},[a.projectId]),P=_.useCallback(async()=>{if(!a.projectId)return;const y=await ge(a.projectId);l(d=>({...d,requirements:y}))},[a.projectId]),o=_.useCallback(async()=>{if(!a.projectId||a.bids.length===0)return;const{data:y}=await $.from("bid_questions").select("*").in("bid_id",a.bids.map(d=>d.bid.id)).order("display_order",{ascending:!0});l(d=>({...d,questions:y||[]}))},[a.projectId,a.bids]),N=_.useCallback(y=>Tt[y],[]),j={...a,goToPhase:w,completePhase:C,canAccessPhase:b,refreshBids:A,refreshRequirements:P,refreshQuestions:o,getPhaseLabel:N};return e.jsx(Fe.Provider,{value:j,children:n})}function Q(){const n=_.useContext(Fe);if(!n)throw new Error("usePhase must be used within a PhaseProvider");return n}const Se=[{phase:1,label:"GATHER"},{phase:2,label:"COMPARE"},{phase:3,label:"DECIDE"},{phase:4,label:"VERIFY"}];function Ft({children:n,onNavigateHome:i,projectName:c}){const{currentPhase:a,phaseStatus:l,goToPhase:b,canAccessPhase:w}=Q();return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[i&&e.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-100",children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-600 hover:text-switch-green-600 transition-colors group","aria-label":"Return to Bid Compare Dashboard",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 group-hover:bg-switch-green-100 flex items-center justify-center transition-colors",children:e.jsx(bt,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:"Dashboard"})]}),e.jsx(ue,{className:"w-4 h-4 text-gray-300"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate max-w-[200px] sm:max-w-none",children:c||"Current Project"})]}),e.jsx("div",{className:"flex items-center justify-between",children:Se.map((C,A)=>{const P=l[C.phase],o=a===C.phase,N=w(C.phase);return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("button",{onClick:()=>N&&b(C.phase),disabled:!N,className:`
                      flex items-center gap-2 transition-all
                      ${N?"cursor-pointer":"cursor-not-allowed"}
                      ${o?"opacity-100":N?"opacity-70 hover:opacity-100":"opacity-40"}
                    `,children:[e.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold transition-colors
                        ${P==="completed"?"bg-switch-green-600 text-white":""}
                        ${P==="active"&&o?"bg-switch-green-600 text-white":""}
                        ${P==="active"&&!o?"bg-switch-green-100 text-switch-green-700 border-2 border-switch-green-600":""}
                        ${P==="locked"?"bg-gray-200 text-gray-400":""}
                      `,children:P==="completed"?e.jsx(Me,{className:"w-4 h-4"}):C.phase}),e.jsx("span",{className:`
                        text-sm font-medium hidden sm:block
                        ${o?"text-gray-900":"text-gray-500"}
                      `,children:C.label})]}),A<Se.length-1&&e.jsx("div",{className:"flex-1 mx-3",children:e.jsx("div",{className:`
                          h-0.5 transition-colors
                          ${l[A+2]!=="locked"||l[A+1]==="completed"?"bg-switch-green-600":"bg-gray-200"}
                        `})})]},C.phase)})}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"h-1 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-switch-green-600 transition-all duration-500",style:{width:`${(a-1)/3*100+(l[a]==="completed"?25:0)}%`}})})})]})}),e.jsx("main",{className:"flex-1 max-w-4xl w-full mx-auto px-4 py-6",children:n})]})}function Z({label:n,value:i,onChange:c,description:a}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:n}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i,"/5"]})]}),e.jsx("input",{type:"range",min:"1",max:"5",value:i,onChange:l=>c(parseInt(l.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-switch-green-600"}),e.jsx("p",{className:"text-xs text-gray-500",children:a})]})}function Ie(){const{projectId:n,project:i,bids:c,requirements:a,completePhase:l,refreshRequirements:b}=Q(),[w,C]=_.useState({price:(a==null?void 0:a.priority_price)??3,efficiency:(a==null?void 0:a.priority_efficiency)??3,warranty:(a==null?void 0:a.priority_warranty)??3,reputation:(a==null?void 0:a.priority_reputation)??3,timeline:(a==null?void 0:a.priority_timeline)??3}),[A,P]=_.useState(!1),[o,N]=_.useState(!1),[j,y]=_.useState((i==null?void 0:i.data_sharing_consent)??!1),[d,g]=_.useState(!1);_.useEffect(()=>{a&&C({price:a.priority_price??3,efficiency:a.priority_efficiency??3,warranty:a.priority_warranty??3,reputation:a.priority_reputation??3,timeline:a.priority_timeline??3})},[a]),_.useEffect(()=>{i&&y(i.data_sharing_consent??!1)},[i]);const S=c.filter(m=>m.bid.total_bid_amount>0&&m.bid.contractor_name).length>=2,q=m=>{m.preventDefault(),m.stopPropagation(),m.type==="dragenter"||m.type==="dragover"?N(!0):m.type==="dragleave"&&N(!1)},x=m=>{m.preventDefault(),m.stopPropagation(),N(!1)},f=async()=>{if(!(!n||!S)){P(!0);try{await $t(n,{priority_price:w.price,priority_efficiency:w.efficiency,priority_warranty:w.warranty,priority_reputation:w.reputation,priority_timeline:w.timeline}),await It(n,j),await b(),l(1)}catch(m){console.error("Failed to save requirements:",m)}finally{P(!1)}}},h=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),M=m=>m.bid.total_bid_amount>0?e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}):e.jsx(fe,{className:"w-5 h-5 text-amber-500"}),B=m=>m.bid.total_bid_amount>0?"Ready":"Processing";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gather Your Bids"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Upload at least 2 contractor bids to compare, then tell us what matters most to you."})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-switch-green-600"}),"Upload Your Bids"]}),e.jsxs("div",{onDragEnter:q,onDragLeave:q,onDragOver:q,onDrop:x,className:`
            border-2 border-dashed rounded-xl p-8 text-center transition-colors
            ${o?"border-switch-green-500 bg-switch-green-50":"border-gray-300 hover:border-gray-400"}
          `,children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(de,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Drag and drop PDF bid documents here"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"or"}),e.jsx("button",{className:"btn btn-secondary",children:"Browse Files"}),e.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Supported formats: PDF (max 10MB each)"})]}),c.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Uploaded Bids (",c.length,")"]}),c.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(de,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:m.bid.contractor_name||m.bid.contractor_company||"Unknown Contractor"}),e.jsx("p",{className:"text-sm text-gray-500",children:m.bid.total_bid_amount>0?h(m.bid.total_bid_amount):"Processing..."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm ${m.bid.total_bid_amount>0?"text-switch-green-600":"text-amber-500"}`,children:B(m)}),M(m)]})]},m.bid.id))]}),e.jsxs("button",{className:"btn btn-secondary w-full mt-4 flex items-center justify-center gap-2",children:[e.jsx(wt,{className:"w-4 h-4"}),"Add Another Bid"]}),c.length<2&&e.jsxs("div",{className:"mt-4 flex items-start gap-2 text-amber-600 bg-amber-50 rounded-lg p-3",children:[e.jsx(ct,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm",children:["You need at least 2 bids to compare. ",c.length===0?"Upload your first bid to get started.":"Upload 1 more bid to continue."]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"What Matters Most to You?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Adjust these sliders to reflect your priorities. We will use these to highlight the best options for you."}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{label:"Upfront Cost",value:w.price,onChange:m=>C(T=>({...T,price:m})),description:"How important is getting the lowest price?"}),e.jsx(Z,{label:"Energy Efficiency / Long-term Savings",value:w.efficiency,onChange:m=>C(T=>({...T,efficiency:m})),description:"Higher efficiency means lower utility bills over time"}),e.jsx(Z,{label:"Warranty Length",value:w.warranty,onChange:m=>C(T=>({...T,warranty:m})),description:"Longer warranties provide peace of mind"}),e.jsx(Z,{label:"Contractor Reputation",value:w.reputation,onChange:m=>C(T=>({...T,reputation:m})),description:"Experience, reviews, and certifications"}),e.jsx(Z,{label:"Installation Timeline",value:w.timeline,onChange:m=>C(T=>({...T,timeline:m})),description:"How quickly can they complete the work?"})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-5",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[e.jsx("div",{className:"pt-0.5",children:e.jsx("input",{type:"checkbox",checked:j,onChange:m=>y(m.target.checked),className:"w-5 h-5 rounded border-gray-300 text-switch-green-600 focus:ring-switch-green-500 focus:ring-offset-0 cursor-pointer"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ct,{className:"w-4 h-4 text-switch-green-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Help other homeowners by sharing anonymized bid data"})]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Your pricing data helps others understand fair market rates in your area. All personal and contractor details are removed before sharing."}),e.jsxs("button",{type:"button",onClick:m=>{m.preventDefault(),g(!d)},className:"text-sm text-switch-green-600 hover:text-switch-green-700 mt-2 flex items-center gap-1",children:[e.jsx(Te,{className:"w-3.5 h-3.5"}),d?"Hide privacy details":"What data is shared?"]}),d&&e.jsxs("div",{className:"mt-3 p-4 bg-white rounded-lg border border-gray-200 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:"Data that IS shared (anonymized):"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[e.jsx("li",{children:"Bid amounts and pricing breakdowns"}),e.jsx("li",{children:"Equipment types, efficiency ratings, and specifications"}),e.jsx("li",{children:"General location (ZIP code area only)"}),e.jsx("li",{children:"Project scope (system size, features included)"})]}),e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:"Data that is NEVER shared:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Your name, email, or contact information"}),e.jsx("li",{children:"Your exact address"}),e.jsx("li",{children:"Contractor names or contact details"}),e.jsx("li",{children:"Original PDF documents"})]}),e.jsx("p",{className:"mt-4 text-gray-500 text-xs",children:"You can change this preference at any time in your project settings."})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:f,disabled:!S||A,className:"btn btn-primary flex items-center gap-2 px-6",children:[A?"Saving...":"Continue to Compare",e.jsx(ye,{className:"w-4 h-4"})]})}),!S&&e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Upload at least 2 bids to continue"})]})}const re="200px",Pe="180px";function Ut(){var V,Y;const{bids:n,requirements:i,completePhase:c}=Q(),[a,l]=_.useState("equipment"),[b,w]=_.useState(!1),[C,A]=_.useState(!1),[P,o]=_.useState(!1),N=t=>t?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"-",j=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-",y=(t,r=!0)=>{const D=t.filter(R=>R!=null);return D.length===0?null:r?Math.max(...D):Math.min(...D)},d=(t,r)=>t==null||r==null?!1:t===r,g=[{key:"equipment",label:"Equipment",description:"Specs, efficiency ratings, and features",icon:e.jsx(We,{className:"w-5 h-5"})},{key:"contractors",label:"Contractors",description:"Experience, ratings, and certifications",icon:e.jsx(Ee,{className:"w-5 h-5"})},{key:"costs",label:"Costs",description:"Pricing, warranties, and inclusions",icon:e.jsx(Be,{className:"w-5 h-5"})}],k=()=>n.map(t=>{const r=t.equipment.find(D=>D.equipment_type==="outdoor_unit"||D.equipment_type==="heat_pump")||t.equipment[0];return{bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",brand:(r==null?void 0:r.brand)||"-",model:(r==null?void 0:r.model_number)||(r==null?void 0:r.model_name)||"-",seer2:(r==null?void 0:r.seer2_rating)||(r==null?void 0:r.seer_rating),hspf2:(r==null?void 0:r.hspf2_rating)||(r==null?void 0:r.hspf_rating),capacityTons:r==null?void 0:r.capacity_tons,capacityBtu:r==null?void 0:r.capacity_btu,variableSpeed:r==null?void 0:r.variable_speed,soundLevel:r==null?void 0:r.sound_level_db,energyStar:r==null?void 0:r.energy_star_certified,energyStarMostEfficient:r==null?void 0:r.energy_star_most_efficient,refrigerantType:r==null?void 0:r.refrigerant_type,voltage:r==null?void 0:r.voltage,stages:r==null?void 0:r.stages,cop:r==null?void 0:r.cop,eer:r==null?void 0:r.eer_rating,compressorWarranty:r==null?void 0:r.compressor_warranty_years}}),S=()=>n.map(t=>({bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",yearsInBusiness:t.bid.contractor_years_in_business,yearEstablished:t.bid.contractor_year_established,googleRating:t.bid.contractor_google_rating,reviewCount:t.bid.contractor_google_review_count,certifications:t.bid.contractor_certifications||[],license:t.bid.contractor_license,licenseState:t.bid.contractor_license_state,insuranceVerified:t.bid.contractor_insurance_verified,isSwitchPreferred:t.bid.contractor_is_switch_preferred,phone:t.bid.contractor_phone,email:t.bid.contractor_email,website:t.bid.contractor_website,totalInstalls:t.bid.contractor_total_installs})),q=()=>n.map(t=>({bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",totalAmount:t.bid.total_bid_amount,equipmentCost:t.bid.equipment_cost,laborCost:t.bid.labor_cost,materialsCost:t.bid.materials_cost,permitCost:t.bid.permit_cost,laborWarranty:t.bid.labor_warranty_years,equipmentWarranty:t.bid.equipment_warranty_years,financingAvailable:t.bid.financing_offered,financingTerms:t.bid.financing_terms,inclusions:t.bid.inclusions||[],exclusions:t.bid.exclusions||[],estimatedDays:t.bid.estimated_days,startDateAvailable:t.bid.start_date_available,validUntil:t.bid.valid_until,bidDate:t.bid.bid_date,depositRequired:t.bid.deposit_required,depositPercentage:t.bid.deposit_percentage,paymentSchedule:t.bid.payment_schedule})),x=k(),f=S(),h=q(),M=y(x.map(t=>t.seer2)),B=y(x.map(t=>t.hspf2)),m=y(f.map(t=>t.yearsInBusiness)),T=y(f.map(t=>t.googleRating)),W=y(h.map(t=>t.totalAmount),!1),z=y(h.map(t=>t.laborWarranty)),K=y(h.map(t=>t.equipmentWarranty)),ee=y(h.map(t=>t.estimatedDays),!1),ie=()=>{if(!i||n.length===0)return null;let t=null,r=-1;n.forEach(R=>{const O=x.find(L=>L.bidId===R.bid.id),F=h.find(L=>L.bidId===R.bid.id),E=f.find(L=>L.bidId===R.bid.id);let G=0;if(F!=null&&F.totalAmount&&W){const L=W/F.totalAmount*i.priority_price;G+=L}if(O!=null&&O.seer2&&M){const L=O.seer2/M*i.priority_efficiency;G+=L}if(F!=null&&F.laborWarranty&&z){const L=F.laborWarranty/z*i.priority_warranty;G+=L}if(E!=null&&E.googleRating&&T){const L=E.googleRating/T*i.priority_reputation;G+=L}G>r&&(r=G,t=R.bid.id)});const D=n.find(R=>R.bid.id===t);return D?{contractor:D.bid.contractor_name||D.bid.contractor_company||"Unknown",reason:ne(D.bid.id)}:null},ne=t=>{const r=[],D=h.find(O=>O.bidId===t),R=x.find(O=>O.bidId===t);return(D==null?void 0:D.totalAmount)===W&&r.push("lowest price"),(R==null?void 0:R.seer2)===M&&r.push("highest efficiency"),(D==null?void 0:D.laborWarranty)===z&&z&&z>1&&r.push("best warranty"),r.length===0&&r.push("best overall balance of your priorities"),`Based on your priorities, this bid offers the ${r.join(", ")}.`},J=ie(),oe=()=>{c(2)},s=n.length,v=`calc(${re} + (${s} * ${Pe}))`,p={width:re,minWidth:re,maxWidth:re},u={minWidth:Pe};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Compare Your Bids"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review the equipment, contractors, and costs side by side."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:g.map((t,r)=>e.jsxs("button",{onClick:()=>l(t.key),className:`
              relative p-4 rounded-xl text-left transition-all duration-200 border-2
              ${a===t.key?"bg-gradient-to-br from-switch-green-50 to-switch-green-100 border-switch-green-500 shadow-md":"bg-white border-gray-200 hover:border-gray-300 hover:shadow-sm"}
            `,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`
                w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0
                ${a===t.key?"bg-switch-green-600 text-white":"bg-gray-100 text-gray-500"}
              `,children:t.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`
                    text-xs font-medium px-2 py-0.5 rounded-full
                    ${a===t.key?"bg-switch-green-600 text-white":"bg-gray-200 text-gray-600"}
                  `,children:[r+1," of 3"]})}),e.jsx("h3",{className:`
                  font-semibold mt-1
                  ${a===t.key?"text-switch-green-800":"text-gray-900"}
                `,children:t.label}),e.jsx("p",{className:`
                  text-sm mt-0.5
                  ${a===t.key?"text-switch-green-700":"text-gray-500"}
                `,children:t.description})]})]}),a===t.key&&e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2",children:e.jsx("div",{className:"w-3 h-3 bg-switch-green-500 rotate-45"})})]},t.key))}),e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:`
          px-5 py-3 border-b-2 border-gray-200 flex items-center gap-3
          bg-gradient-to-r from-switch-green-600 to-switch-green-700
        `,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center text-white",children:(V=g.find(t=>t.key===a))==null?void 0:V.icon}),e.jsxs("h2",{className:"font-semibold text-white",children:[(Y=g.find(t=>t.key===a))==null?void 0:Y.label," Comparison"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",style:{minWidth:v,tableLayout:"fixed"},children:[a==="equipment"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Specification"}),x.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<x.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Manufacturer & Model"}),x.map((t,r)=>e.jsxs("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<x.length-1?"border-r border-gray-100":""}`,children:[t.brand," ",t.model]},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"SEER2 Rating"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.seer2,M)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<x.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.seer2||"-",d(t.seer2,M)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"HSPF2 Rating"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.hspf2,B)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<x.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.hspf2||"-",d(t.hspf2,B)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Capacity (tons)"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.capacityTons||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Variable Speed"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<x.length-1?"border-r border-gray-100":""}`,children:t.variableSpeed?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(H,{className:"w-5 h-5"})," Yes"]}):t.variableSpeed===!1?e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Sound Level (dB)"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.soundLevel||"-"},t.bidId))]}),e.jsxs("tr",{className:b?"border-b border-gray-200":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"ENERGY STAR"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<x.length-1?"border-r border-gray-100":""}`,children:t.energyStar?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(H,{className:"w-5 h-5"})," Certified"]}):t.energyStar===!1?e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Capacity (BTU)"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.capacityBtu?t.capacityBtu.toLocaleString():"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Refrigerant Type"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.refrigerantType||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Voltage"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.voltage?`${t.voltage}V`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Stages"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.stages||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"COP Rating"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.cop||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"EER Rating"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.eer||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Compressor Warranty"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<x.length-1?"border-r border-gray-100":""}`,children:t.compressorWarranty?`${t.compressorWarranty} years`:"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Most Efficient"}),x.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<x.length-1?"border-r border-gray-100":""}`,children:t.energyStarMostEfficient?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(H,{className:"w-5 h-5"})," Yes"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]})]})]})]}),a==="contractors"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Information"}),f.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<f.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Years in Business"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.yearsInBusiness,m)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<f.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.yearsInBusiness?`${t.yearsInBusiness} years`:"-",d(t.yearsInBusiness,m)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," MOST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Google Rating"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.googleRating,T)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<f.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.googleRating?e.jsxs("span",{className:"flex items-center gap-1",children:[t.googleRating,e.jsx(U,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"})]}):"-",d(t.googleRating,T)&&e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:"TOP"})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Review Count"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.reviewCount?`${t.reviewCount} reviews`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Certifications"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.certifications.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.certifications.slice(0,3).map((D,R)=>e.jsx("span",{className:"inline-flex px-2 py-0.5 bg-gray-100 text-gray-700 text-xs font-medium rounded",children:D},R)),t.certifications.length>3&&e.jsxs("span",{className:"inline-flex px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded",children:["+",t.certifications.length-3]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"License Number"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.license||e.jsx("span",{className:"text-gray-400",children:"Not provided"})},t.bidId))]}),e.jsxs("tr",{className:C?"border-b border-gray-200 bg-gray-50/50":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Switch Preferred"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<f.length-1?"border-r border-gray-100":""}`,children:t.isSwitchPreferred?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-gradient-to-r from-switch-green-500 to-switch-green-600 text-white rounded-full text-xs font-semibold shadow-sm",children:[e.jsx(H,{className:"w-3.5 h-3.5"})," Preferred Partner"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),C&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Phone"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.phone||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Email"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.email?e.jsx("a",{href:`mailto:${t.email}`,className:"text-switch-green-600 hover:underline truncate block",children:t.email}):"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Website"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.website?e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-switch-green-600 hover:underline truncate block",children:t.website.replace(/^https?:\/\//,"")}):"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"License State"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.licenseState||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Insurance Verified"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<f.length-1?"border-r border-gray-100":""}`,children:t.insuranceVerified?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700",children:[e.jsx(H,{className:"w-4 h-4"})," Verified"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Year Established"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.yearEstablished||"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Total Installs"}),f.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<f.length-1?"border-r border-gray-100":""}`,children:t.totalInstalls?t.totalInstalls.toLocaleString():"-"},t.bidId))]})]})]})]}),a==="costs"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Cost Item"}),h.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<h.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:[e.jsx("td",{style:p,className:"px-5 py-5 text-sm font-bold text-gray-900 bg-gray-100 border-r border-gray-200",children:"Total Bid Amount"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-5 ${d(t.totalAmount,W)?"bg-gradient-to-r from-switch-green-50 to-switch-green-100":""} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xl font-bold ${d(t.totalAmount,W)?"text-switch-green-700":"text-gray-900"}`,children:N(t.totalAmount)}),d(t.totalAmount,W)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," LOWEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Equipment Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:N(t.equipmentCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Labor Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:N(t.laborCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Labor Warranty"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.laborWarranty,z)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.laborWarranty?`${t.laborWarranty} years`:"-",d(t.laborWarranty,z)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Equipment Warranty"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${d(t.equipmentWarranty,K)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.equipmentWarranty?`${t.equipmentWarranty} years`:"-",d(t.equipmentWarranty,K)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Financing Available"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<h.length-1?"border-r border-gray-100":""}`,children:t.financingAvailable?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(H,{className:"w-5 h-5"})," Available"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"What is Included"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.inclusions.length>0?e.jsxs("ul",{className:"text-xs space-y-1.5",children:[t.inclusions.slice(0,4).map((D,R)=>e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(H,{className:"w-3.5 h-3.5 text-switch-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:D})]},R)),t.inclusions.length>4&&e.jsxs("li",{className:"text-gray-500 pl-5",children:["+",t.inclusions.length-4," more items"]})]}):e.jsx("span",{className:"text-gray-400",children:"Not specified"})},t.bidId))]}),e.jsxs("tr",{className:P?"border-b border-gray-200 bg-gray-50/50":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"What is NOT Included"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.exclusions.length>0?e.jsxs("ul",{className:"text-xs space-y-1.5",children:[t.exclusions.slice(0,4).map((D,R)=>e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(te,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:D})]},R)),t.exclusions.length>4&&e.jsxs("li",{className:"text-gray-500 pl-5",children:["+",t.exclusions.length-4," more items"]})]}):e.jsx("span",{className:"text-gray-400",children:"Not specified"})},t.bidId))]}),P&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Estimated Duration"}),h.map((t,r)=>e.jsxs("td",{style:u,className:`px-5 py-4 text-sm ${d(t.estimatedDays,ee)?"text-switch-green-700 font-semibold":"text-gray-600"} ${r<h.length-1?"border-r border-gray-100":""}`,children:[t.estimatedDays?`${t.estimatedDays} days`:"-",d(t.estimatedDays,ee)&&t.estimatedDays&&e.jsx("span",{className:"ml-2 inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:"FASTEST"})]},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Available Start Date"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:j(t.startDateAvailable)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Quote Valid Until"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:j(t.validUntil)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Bid Date"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:j(t.bidDate)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Materials Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:N(t.materialsCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Permit Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:N(t.permitCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Deposit Required"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.depositRequired?N(t.depositRequired):t.depositPercentage?`${t.depositPercentage}%`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Payment Schedule"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.paymentSchedule||"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Financing Terms"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.financingTerms||"-"},t.bidId))]})]})]})]})]})}),e.jsx("div",{className:"px-5 py-3 bg-gray-50 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{a==="equipment"&&w(!b),a==="contractors"&&A(!C),a==="costs"&&o(!P)},className:"flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:a==="equipment"&&b||a==="contractors"&&C||a==="costs"&&P?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4"}),"Show More Details"]})})})]}),J&&e.jsx("div",{className:"bg-switch-green-50 border border-switch-green-200 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-switch-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(U,{className:"w-5 h-5 text-switch-green-700"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-switch-green-900",children:["Recommended: ",J.contractor]}),e.jsx("p",{className:"text-sm text-switch-green-700 mt-1",children:J.reason})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:oe,className:"btn btn-primary flex items-center gap-2 px-6",children:["Continue to Decide",e.jsx(ye,{className:"w-4 h-4"})]})})]})}function Ht({rebatePrograms:n,selectedIncentives:i,onToggleIncentive:c}){const[a,l]=_.useState(new Set),b=o=>{const N=new Set(a);N.has(o)?N.delete(o):N.add(o),l(N)},w=o=>o?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(o):"-",C=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null,A=o=>o.max_rebate||o.rebate_amount||0,P=Array.from(i).reduce((o,N)=>{const j=n.find(y=>y.id===N);return o+(j?A(j):0)},0);return n.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-switch-green-600 to-switch-green-700 px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(Be,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-lg",children:"Available Rebates & Incentives"}),e.jsx("p",{className:"text-switch-green-100 text-sm",children:"Select the incentives you plan to apply for"})]})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:n.map(o=>{const N=a.has(o.id),j=i.has(o.id),y=A(o);return e.jsxs("div",{className:j?"bg-switch-green-50/50":"",children:[e.jsxs("div",{className:"flex items-center gap-3 px-5 py-4",children:[e.jsx("button",{onClick:()=>b(o.id),className:"p-1 hover:bg-gray-100 rounded transition-colors",children:N?e.jsx(ae,{className:"w-5 h-5 text-gray-500"}):e.jsx(ue,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:o.program_name}),o.program_type&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full",children:o.program_type}),o.income_qualified&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full",children:"Income Qualified"})]}),!N&&o.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5 truncate",children:o.description})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-lg font-bold text-switch-green-700",children:o.rebate_percentage?`Up to ${o.rebate_percentage}%`:w(y)}),o.rebate_percentage&&o.max_rebate&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Max: ",w(o.max_rebate)]})]}),e.jsx("button",{onClick:()=>c(o.id),className:"p-1 hover:bg-gray-100 rounded transition-colors",children:j?e.jsx(mt,{className:"w-6 h-6 text-switch-green-600"}):e.jsx(vt,{className:"w-6 h-6 text-gray-400 hover:text-gray-600"})})]})]}),N&&e.jsxs("div",{className:"px-5 pb-5 pl-14 space-y-4",children:[o.description&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-700",children:o.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(o.valid_from||o.valid_until)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Valid Period"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[o.valid_from&&C(o.valid_from),o.valid_from&&o.valid_until&&" - ",o.valid_until&&C(o.valid_until),!o.valid_from&&!o.valid_until&&"Ongoing"]})]})]}),o.typical_processing_days&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Processing Time"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["~",o.typical_processing_days," days"]})]})]}),o.available_states&&o.available_states.length>0&&!o.available_nationwide&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Available In"}),e.jsx("p",{className:"text-sm text-gray-900",children:o.available_states.join(", ")})]})]}),o.available_nationwide&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Availability"}),e.jsx("p",{className:"text-sm text-gray-900",children:"Available Nationwide"})]})]})]}),o.application_process&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"How to Apply"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:o.application_process})]}),o.requirements&&Object.keys(o.requirements).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Requirements"}),e.jsx("ul",{className:"text-sm text-gray-700 mt-1 space-y-1",children:Object.entries(o.requirements).map(([d,g])=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("span",{children:String(g)})]},d))})]}),!o.stackable&&o.cannot_stack_with&&o.cannot_stack_with.length>0&&e.jsxs("div",{className:"text-sm text-amber-700 bg-amber-50 rounded-lg p-3",children:[e.jsx("span",{className:"font-medium",children:"Note:"})," Cannot be combined with: ",o.cannot_stack_with.join(", ")]}),o.application_url&&e.jsxs("a",{href:o.application_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-switch-green-600 hover:text-switch-green-700 font-medium",children:[e.jsx(yt,{className:"w-4 h-4"}),"View Application Details"]})]})]},o.id)})}),e.jsx("div",{className:"bg-gray-50 px-5 py-4 border-t-2 border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[i.size," of ",n.length," selected"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Estimated Total Savings"}),e.jsx("p",{className:"text-2xl font-bold text-switch-green-700",children:w(P)})]})]})})]})}function Ot(){const{bids:n,questions:i,refreshQuestions:c,completePhase:a}=Q(),[l,b]=_.useState([]),[w,C]=_.useState(new Set),[A,P]=_.useState(null),[o,N]=_.useState(null),[j,y]=_.useState(new Set);_.useEffect(()=>{d()},[]);const d=async()=>{const{data:s}=await $.from("rebate_programs").select("*").eq("is_active",!0).order("program_name");s&&(b(s),C(new Set(s.map(v=>v.id))))},g=s=>{const v=new Set(w);v.has(s)?v.delete(s):v.add(s),C(v)},k=()=>Array.from(w).reduce((s,v)=>{const p=l.find(u=>u.id===v);return s+(p&&(Number(p.max_rebate)||Number(p.rebate_amount))||0)},0),S=s=>s?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s):"-",q=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null,x=async s=>{await $.from("bid_questions").update({is_answered:!s.is_answered,answered_at:s.is_answered?null:new Date().toISOString()}).eq("id",s.id),c()},f=s=>i.filter(v=>v.bid_id===s),h=(s,v)=>{const u=f(s).filter(Y=>!Y.is_answered),V=`Questions for ${v}:

${u.map((Y,t)=>`${t+1}. ${Y.question_text}`).join(`

`)}`;navigator.clipboard.writeText(V),N(s),setTimeout(()=>N(null),2e3)},M=s=>{switch(s){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},B=s=>{const v=new Set(j);v.has(s)?v.delete(s):v.add(s),y(v)},m=k(),W=n.map(s=>{const v=s.equipment.find(u=>u.equipment_type==="outdoor_unit"||u.equipment_type==="heat_pump")||s.equipment[0],p=s.bid.total_bid_amount-m;return{bidId:s.bid.id,contractor:s.bid.contractor_name||s.bid.contractor_company||"Unknown",totalAmount:s.bid.total_bid_amount,estimatedRebates:m,netCost:p,equipmentBrand:(v==null?void 0:v.brand)||"-",equipmentModel:(v==null?void 0:v.model_number)||(v==null?void 0:v.model_name)||"-",seer2:(v==null?void 0:v.seer2_rating)||(v==null?void 0:v.seer_rating),googleRating:s.bid.contractor_google_rating,reviewCount:s.bid.contractor_google_review_count,laborWarranty:s.bid.labor_warranty_years,equipmentWarranty:s.bid.equipment_warranty_years,isSwitchPreferred:s.bid.contractor_is_switch_preferred,phone:s.bid.contractor_phone,email:s.bid.contractor_email,website:s.bid.contractor_website,license:s.bid.contractor_license,licenseState:s.bid.contractor_license_state,insuranceVerified:s.bid.contractor_insurance_verified,yearsInBusiness:s.bid.contractor_years_in_business,totalInstalls:s.bid.contractor_total_installs,certifications:s.bid.contractor_certifications||[],estimatedDays:s.bid.estimated_days,startDateAvailable:s.bid.start_date_available,validUntil:s.bid.valid_until,bidDate:s.bid.bid_date,financingOffered:s.bid.financing_offered,financingTerms:s.bid.financing_terms,userNotes:s.bid.user_notes,isFavorite:s.bid.is_favorite,verifiedByUser:s.bid.verified_by_user,extractionConfidence:s.bid.extraction_confidence,valueScore:s.bid.value_score,qualityScore:s.bid.quality_score,completenessScore:s.bid.completeness_score}}),z=Math.min(...W.map(s=>s.totalAmount||1/0)),K=Math.min(...W.map(s=>s.netCost||1/0)),ee=Math.max(...W.map(s=>s.googleRating||0)),ie=Math.max(...W.map(s=>s.seer2||0)),ne=Math.max(...W.map(s=>(s.laborWarranty||0)+(s.equipmentWarranty||0))),J=()=>{a(3)},oe=s=>{P(A===s?null:s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Make Your Decision"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review each bid side by side, ask clarifying questions, and choose your contractor."})]}),l.length>0&&e.jsx(Ht,{rebatePrograms:l,selectedIncentives:w,onToggleIncentive:g}),e.jsx("div",{className:"space-y-6",children:W.map(s=>{const v=f(s.bidId),p=v.filter(E=>E.is_answered).length,u=v.filter(E=>!E.is_answered),V=A===s.bidId,Y=j.has(s.bidId),t=s.totalAmount===z,r=s.netCost===K,D=s.googleRating===ee&&s.googleRating>0,R=s.seer2===ie&&s.seer2>0,O=(s.laborWarranty||0)+(s.equipmentWarranty||0),F=O===ne&&O>0;return e.jsxs("div",{className:`
                relative bg-white rounded-xl overflow-hidden transition-all duration-200
                ${V?"ring-4 ring-switch-green-500 shadow-xl border-2 border-switch-green-500":"border-2 border-gray-200 shadow-md hover:shadow-lg hover:border-gray-300"}
              `,children:[e.jsx("div",{className:`
                absolute top-0 left-0 w-1.5 h-full
                ${V?"bg-switch-green-500":"bg-gradient-to-b from-switch-green-400 to-switch-green-600"}
              `}),e.jsxs("div",{className:"p-6 pl-8",children:[e.jsxs("div",{className:"flex items-start justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.contractor}),s.isSwitchPreferred&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-gradient-to-r from-switch-green-500 to-switch-green-600 text-white rounded-full text-xs font-medium",children:[e.jsx(Ee,{className:"w-3 h-3"})," Switch Preferred"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[V&&e.jsx("div",{className:"w-8 h-8 bg-switch-green-500 rounded-full flex items-center justify-center",children:e.jsx(H,{className:"w-5 h-5 text-white"})}),e.jsx("button",{onClick:()=>oe(s.bidId),className:`
                        py-2 px-4 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 text-sm
                        ${V?"bg-switch-green-600 text-white hover:bg-switch-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"}
                      `,children:V?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4"}),"My Choice"]}):"Mark as My Choice"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-5 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Price"}),t&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-switch-green-600 text-white text-xs font-semibold rounded-full",children:[e.jsx(U,{className:"w-3 h-3"})," LOWEST"]})]}),e.jsx("div",{className:`text-3xl font-bold ${t?"text-switch-green-700":"text-gray-900"}`,children:S(s.totalAmount)}),m>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Selected Rebates"}),e.jsxs("span",{className:"text-switch-green-600 font-semibold",children:["-",S(m)]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Net Cost"}),e.jsx("span",{className:`text-xl font-bold ${r?"text-switch-green-700":"text-gray-900"}`,children:S(s.netCost)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(We,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Equipment"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900",title:`${s.equipmentBrand} ${s.equipmentModel}`,children:s.equipmentBrand}),s.seer2&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsxs("span",{className:`text-xs ${R?"text-switch-green-700 font-bold":"text-gray-600"}`,children:["SEER2: ",s.seer2]}),R&&e.jsx(U,{className:"w-3 h-3 text-switch-green-600"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(U,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Rating"})]}),s.googleRating?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`text-sm font-bold ${D?"text-switch-green-700":"text-gray-900"}`,children:[s.googleRating.toFixed(1)," / 5",D&&e.jsx(U,{className:"w-3 h-3 inline ml-1 text-switch-green-600"})]}),s.reviewCount&&e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[s.reviewCount," reviews"]})]}):e.jsx("div",{className:"text-sm text-gray-400",children:"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{className:"w-4 h-4 text-switch-green-600"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Warranty"})]}),s.laborWarranty||s.equipmentWarranty?e.jsxs("div",{className:"space-y-0.5",children:[s.laborWarranty&&e.jsxs("div",{className:`text-xs ${F?"text-switch-green-700 font-bold":"text-gray-900"}`,children:[s.laborWarranty,"yr labor"]}),s.equipmentWarranty&&e.jsxs("div",{className:`text-xs ${F?"text-switch-green-700 font-bold":"text-gray-900"}`,children:[s.equipmentWarranty,"yr equip"]}),F&&e.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-switch-green-600 text-white text-[10px] font-medium rounded mt-1",children:"BEST"})]}):e.jsx("div",{className:"text-sm text-gray-400",children:"N/A"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"bg-gray-100 px-5 py-3 flex items-center justify-between border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-bold text-gray-800",children:"Questions to Ask This Contractor"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full border",children:[p,"/",v.length," answered"]}),u.length>0&&e.jsx("button",{onClick:()=>h(s.bidId,s.contractor),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 bg-white hover:bg-gray-50 border border-gray-300 rounded-lg transition-colors",title:"Copy questions",children:o===s.bidId?e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-4 h-4 text-switch-green-600"}),e.jsx("span",{className:"text-switch-green-600 font-medium",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"w-4 h-4"}),e.jsx("span",{children:"Copy All"})]})})]})]}),e.jsx("div",{className:"p-4 flex-1 overflow-y-auto max-h-72",children:v.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No questions for this bid."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:v.map(E=>e.jsxs("div",{className:`flex items-start gap-2 p-3 rounded-lg transition-colors ${E.is_answered?"bg-gray-50 opacity-60":"bg-white border border-gray-200 hover:border-gray-300"}`,children:[e.jsx("button",{onClick:()=>x(E),className:"flex-shrink-0 mt-0.5",children:E.is_answered?e.jsx(H,{className:"w-5 h-5 text-switch-green-600"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 hover:border-switch-green-500 transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm ${E.is_answered?"text-gray-400 line-through":"text-gray-800"}`,children:E.question_text}),!E.is_answered&&e.jsx("div",{className:"flex items-center gap-1 mt-1.5",children:e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border font-medium ${M(E.priority)}`,children:E.priority})})]})]},E.id))})})]})})]}),Y&&e.jsx("div",{className:"mt-5 pt-5 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Contact Info"}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(jt,{className:"w-4 h-4 text-gray-400"}),s.phone]}),s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:`mailto:${s.email}`,className:"text-switch-green-600 hover:underline",children:s.email})]}),s.website&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ut,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-switch-green-600 hover:underline truncate",children:s.website.replace(/^https?:\/\//,"")})]}),s.license&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"License:"})," ",s.license,s.licenseState&&` (${s.licenseState})`]}),s.insuranceVerified&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-switch-green-700",children:[e.jsx(H,{className:"w-4 h-4"})," Insurance Verified"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Timeline & Details"}),s.estimatedDays&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-400"}),"Est. ",s.estimatedDays," days to complete"]}),s.startDateAvailable&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),"Available: ",q(s.startDateAvailable)]}),s.validUntil&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"Quote valid until:"})," ",q(s.validUntil)]}),s.bidDate&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"Bid date:"})," ",q(s.bidDate)]}),s.financingOffered&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-switch-green-700 font-medium",children:"Financing Available"}),s.financingTerms&&e.jsxs("span",{className:"text-gray-500 ml-1",children:["- ",s.financingTerms]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Experience"}),s.yearsInBusiness&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.yearsInBusiness," years in business"]}),s.totalInstalls&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.totalInstalls.toLocaleString()," total installs"]}),s.certifications.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.certifications.map((E,G)=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded",children:E},G))}),s.extractionConfidence&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Extraction confidence: ",e.jsx("span",{className:"capitalize font-medium",children:s.extractionConfidence})]}),(s.valueScore||s.qualityScore||s.completenessScore)&&e.jsxs("div",{className:"flex items-center gap-2",children:[s.valueScore&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-switch-green-100 text-switch-green-700 rounded",children:["Value: ",s.valueScore]}),s.qualityScore&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-700 rounded",children:["Quality: ",s.qualityScore]})]})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>B(s.bidId),className:"flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors",children:Y?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4"}),"Show More Details"]})})})]})]},s.bidId)})}),n.length===0&&e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 p-12 text-center",children:[e.jsx(Ne,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Bids to Compare"}),e.jsx("p",{className:"text-gray-600",children:"Upload your contractor bids in the Gather phase to see them here."})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Note:"})," Marking a contractor as your choice is optional and for your reference only. You will work directly with your chosen contractor to finalize the installation."]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:J,className:"btn btn-primary flex items-center gap-2 px-6",children:["Continue",e.jsx(ye,{className:"w-4 h-4"})]})})]})}const qe={pre_installation:{label:"Pre-Installation",description:"Verify these items before work begins"},equipment:{label:"Equipment Verification",description:"Confirm the right equipment was delivered and installed"},airflow:{label:"Airflow",description:"Proper airflow is critical for efficiency and comfort"},refrigerant:{label:"Refrigerant",description:"Correct refrigerant charge affects efficiency and equipment life"},electrical:{label:"Electrical",description:"Safe and proper electrical connections"},commissioning:{label:"Commissioning & Closeout",description:"Final steps to ensure everything is documented"}};function Vt(){const{projectId:n}=Q(),[i,c]=_.useState([]),[a,l]=_.useState(!0),[b,w]=_.useState("pre_installation");_.useEffect(()=>{n&&C()},[n]);async function C(){const{data:g}=await $.from("qii_checklist_items").select("*").order("display_order",{ascending:!0}),{data:k}=await $.from("project_qii_checklist").select("*").eq("project_id",n),S=new Map((k==null?void 0:k.map(x=>[x.checklist_item_id,x]))||[]),q=(g||[]).map(x=>({...x,status:S.get(x.id)}));c(q),l(!1)}async function A(g){var S;const k=((S=g.status)==null?void 0:S.is_verified)||!1;g.status?await $.from("project_qii_checklist").update({is_verified:!k,verified_at:k?null:new Date().toISOString(),verified_by:k?null:"homeowner"}).eq("id",g.status.id):await $.from("project_qii_checklist").insert({project_id:n,checklist_item_id:g.id,is_verified:!0,verified_at:new Date().toISOString(),verified_by:"homeowner"}),C()}function P(){const g=i.length,k=i.filter(x=>{var f;return(f=x.status)==null?void 0:f.is_verified}).length,S=i.filter(x=>x.is_critical),q=S.filter(x=>{var f;return(f=x.status)==null?void 0:f.is_verified}).length;return{total:g,verified:k,percentage:g>0?Math.round(k/g*100):0,critical:S.length,criticalVerified:q,criticalComplete:q===S.length}}function o(g){return i.filter(k=>k.category===g)}function N(g){const k=o(g),S=k.filter(q=>{var x;return(x=q.status)==null?void 0:x.is_verified}).length;return{total:k.length,verified:S}}function j(){window.print()}const y=P(),d=Object.keys(qe);return a?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-switch-green-600 mx-auto mb-4"}),"Loading checklist..."]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Verify Your Installation"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Use this checklist to ensure your heat pump was installed correctly."})]}),e.jsxs("button",{onClick:j,className:"btn btn-secondary flex items-center gap-2 print:hidden",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Print"]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[y.verified,"/",y.total]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-switch-green-600 transition-all duration-300",style:{width:`${y.percentage}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[y.percentage,"% complete"]})]}),e.jsxs("div",{className:`rounded-lg p-4 ${y.criticalComplete?"bg-switch-green-50":"bg-amber-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y.criticalComplete?e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}):e.jsx(lt,{className:"w-5 h-5 text-amber-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Critical Items"})]}),e.jsxs("p",{className:`text-sm mt-1 ${y.criticalComplete?"text-switch-green-700":"text-amber-700"}`,children:[y.criticalVerified," of ",y.critical," critical items verified"]})]})]})}),e.jsx("div",{className:"space-y-3",children:d.map(g=>{const k=qe[g],S=N(g),q=b===g,x=o(g),f=S.verified===S.total;return x.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>w(q?null:g),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:k.label}),e.jsx("p",{className:"text-sm text-gray-500",children:k.description})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`text-sm font-medium ${f?"text-switch-green-600":"text-gray-500"}`,children:[S.verified,"/",S.total]}),f&&e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}),q?e.jsx(be,{className:"w-5 h-5 text-gray-400"}):e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]})]}),q&&e.jsx("div",{className:"border-t border-gray-100 divide-y divide-gray-100",children:x.map(h=>{var M,B,m;return e.jsxs("div",{className:`px-4 py-3 flex items-start gap-3 ${(M=h.status)!=null&&M.is_verified?"bg-gray-50":""}`,children:[e.jsx("button",{onClick:()=>A(h),className:"flex-shrink-0 mt-0.5",children:(B=h.status)!=null&&B.is_verified?e.jsx(X,{className:"w-6 h-6 text-switch-green-600"}):e.jsx(xt,{className:"w-6 h-6 text-gray-300 hover:text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:`font-medium ${(m=h.status)!=null&&m.is_verified?"text-gray-500 line-through":"text-gray-900"}`,children:h.item_text}),h.is_critical&&e.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded-full",children:"Critical"})]}),h.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:h.description}),h.why_it_matters&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 text-sm text-blue-700 bg-blue-50 rounded-lg p-2",children:[e.jsx(me,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Why it matters:"})," ",h.why_it_matters]})]})]})]},h.id)})})]},g)})}),y.percentage===100&&e.jsxs("div",{className:"bg-switch-green-50 border border-switch-green-200 rounded-xl p-6 text-center",children:[e.jsx(X,{className:"w-12 h-12 text-switch-green-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-bold text-switch-green-900",children:"Installation Verified!"}),e.jsx("p",{className:"text-switch-green-700 mt-1",children:"All quality installation items have been checked. Keep this checklist for your records."})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-5",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Tips for Using This Checklist"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"1."}),"Ask your contractor to walk through critical items with you before they leave"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"2."}),"Request documentation for items like load calculations and commissioning reports"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"3."}),"Take photos of equipment labels showing model numbers and serial numbers"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"4."}),"Do not sign off on the final payment until critical items are verified"]})]})]})]})}function zt({onNavigateHome:n}){const{currentPhase:i,loading:c,error:a,project:l}=Q(),b=e.jsx(Yt,{loading:c,error:a,currentPhase:i});return e.jsx(Ft,{onNavigateHome:n,projectName:l==null?void 0:l.project_name,children:b})}function Yt({loading:n,error:i,currentPhase:c}){if(n)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-switch-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading your project..."})]})});if(i)return e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[e.jsx("p",{className:"text-red-700",children:i}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary mt-4",children:"Retry"})]});switch(c){case 1:return e.jsx(Ie,{});case 2:return e.jsx(Ut,{});case 3:return e.jsx(Ot,{});case 4:return e.jsx(Vt,{});default:return e.jsx(Ie,{})}}function Gt({user:n,projectId:i,onNavigateHome:c}){return e.jsx(Lt,{userId:n.id,initialProjectId:i,children:e.jsx(zt,{onNavigateHome:c})})}const he="bidsmart_active_project";function Qt(){try{return localStorage.getItem(he)}catch{return null}}function Ae(n){try{n?localStorage.setItem(he,n):localStorage.removeItem(he)}catch{}}function Jt(){const{user:n,loading:i,error:c}=it(),[a,l]=_.useState(null),[b,w]=_.useState(!0);_.useEffect(()=>{const o=Qt();o&&(l(o),w(!1))},[]);const C=o=>{l(o),Ae(o),w(!1)},A=o=>{l(o),Ae(o),w(!1)},P=()=>{w(!0)};return i?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-switch-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading BidSmart..."})]})}):c||!n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl text-red-600",children:"!"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Unable to Load"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There was a problem connecting to the database. Please try refreshing the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Refresh Page"})]})}):b||!a?e.jsx(Bt,{user:n,onSelectProject:C,onCreateProject:A}):e.jsx(Gt,{user:n,projectId:a,onNavigateHome:P})}le.createRoot(document.getElementById("root")).render(e.jsx(Oe.StrictMode,{children:e.jsx(Jt,{})}));
//# sourceMappingURL=index-DutRUNhT.js.map
