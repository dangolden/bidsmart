import{r as j,a as Fe,R as Ue}from"./vendor-wGySg1uH.js";import{c as Oe}from"./supabase-DfwcnzK-.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))o(m);new MutationObserver(m=>{for(const d of m)if(d.type==="childList")for(const w of d.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&o(w)}).observe(document,{childList:!0,subtree:!0});function l(m){const d={};return m.integrity&&(d.integrity=m.integrity),m.referrerPolicy&&(d.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?d.credentials="include":m.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(m){if(m.ep)return;m.ep=!0;const d=l(m);fetch(m.href,d)}})();var qe={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var He=j,Ve=Symbol.for("react.element"),ze=Symbol.for("react.fragment"),Ye=Object.prototype.hasOwnProperty,Ge=He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qe={key:!0,ref:!0,__self:!0,__source:!0};function Ae(i,a,l){var o,m={},d=null,w=null;l!==void 0&&(d=""+l),a.key!==void 0&&(d=""+a.key),a.ref!==void 0&&(w=a.ref);for(o in a)Ye.call(a,o)&&!Qe.hasOwnProperty(o)&&(m[o]=a[o]);if(i&&i.defaultProps)for(o in a=i.defaultProps,a)m[o]===void 0&&(m[o]=a[o]);return{$$typeof:Ve,type:i,key:d,ref:w,props:m,_owner:Ge.current}}ae.Fragment=ze;ae.jsx=Ae;ae.jsxs=Ae;qe.exports=ae;var e=qe.exports,de={},je=Fe;de.createRoot=je.createRoot,de.hydrateRoot=je.hydrateRoot;const Je="https://jzvmlgahptwixtrleaco.supabase.co",Ze="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp6dm1sZ2FocHR3aXh0cmxlYWNvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg4NTk5MzksImV4cCI6MjA4NDQzNTkzOX0.epNrqnRXT__ZlADFaZ3zIDSLtgdfNCPdN-oZYcay--w",$=Oe(Je,Ze,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),$e="bidsmart_user",Xe="demo@theswitchison.org",Ke="Demo User";function et(){if(typeof window>"u")return null;const i=new URLSearchParams(window.location.search),a=i.get("user_email"),l=i.get("user_name");return a?{email:a,name:l||a.split("@")[0]}:null}function tt(){try{const i=localStorage.getItem($e);if(i)return JSON.parse(i)}catch{}return null}function _e(i){try{localStorage.setItem($e,JSON.stringify(i))}catch{}}async function rt(i,a){const{data:l,error:o}=await $.from("users_ext").select("*").eq("email",i).maybeSingle();if(o)throw console.error("Error fetching user:",o),o;if(l)return l;const{data:m,error:d}=await $.from("users_ext").insert({email:i,full_name:a}).select().single();if(d)throw console.error("Error creating user:",d),d;return m}function st(){const[i,a]=j.useState(null),[l,o]=j.useState(!0),[m,d]=j.useState(!1),[w,C]=j.useState(null);return j.useEffect(()=>{async function P(){try{const v=et(),c=tt();let S;v?(S=v,_e(v)):c?S=c:(S={email:Xe,name:Ke},_e(S));const q=await rt(S.email,S.name),f=q.created_at!==q.updated_at||new Date(q.created_at).getTime()<Date.now()-5e3;a(q),d(f)}catch(v){console.error("Error initializing user:",v),C(v instanceof Error?v:new Error("Failed to initialize user"))}finally{o(!1)}}P()},[]),{user:i,loading:l,isReturningUser:m,error:w}}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var at={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),I=(i,a)=>{const l=j.forwardRef(({color:o="currentColor",size:m=24,strokeWidth:d=2,absoluteStrokeWidth:w,className:C="",children:P,...v},c)=>j.createElement("svg",{ref:c,...at,width:m,height:m,stroke:o,strokeWidth:w?Number(d)*24/Number(m):d,className:["lucide",`lucide-${it(i)}`,C].join(" "),...v},[...a.map(([S,q])=>j.createElement(S,q)),...Array.isArray(P)?P:[P]]));return l.displayName=`${i}`,l};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=I("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=I("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=I("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=I("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=I("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=I("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=I("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=I("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=I("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=I("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=I("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=I("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=I("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=I("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=I("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=I("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=I("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=I("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=I("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=I("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=I("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=I("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=I("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=I("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=I("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=I("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=I("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=I("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=I("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=I("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=I("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=I("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=I("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);async function ge(i,a={}){const{data:l,error:o}=await $.from("projects").insert({user_id:i,project_name:a.project_name||"My Heat Pump Project",status:a.status||"draft",...a}).select().single();if(o)throw o;return l}async function Te(i){const{data:a,error:l}=await $.from("projects").select("*").eq("user_id",i).order("created_at",{ascending:!1});if(l)throw l;return a||[]}async function _t(i,a){const{data:l,error:o}=await $.from("contractor_bids").insert({project_id:i,contractor_name:a.contractor_name||"Unknown Contractor",total_bid_amount:a.total_bid_amount||0,extraction_confidence:a.extraction_confidence||"manual",financing_offered:a.financing_offered||!1,verified_by_user:a.verified_by_user||!1,is_favorite:a.is_favorite||!1,...a}).select().single();if(o)throw o;return l}async function Ne(i){const{data:a,error:l}=await $.from("contractor_bids").select("*").eq("project_id",i).order("overall_score",{ascending:!1,nullsFirst:!1});if(l)throw l;return a||[]}async function ve(i){const{data:a,error:l}=await $.from("bid_equipment").select("*").eq("bid_id",i);if(l)throw l;return a||[]}async function wt(i,a){const l=a.map(d=>({bid_id:i,equipment_type:d.equipment_type||"other",brand:d.brand||"Unknown",confidence:d.confidence||"manual",...d})),{data:o,error:m}=await $.from("bid_equipment").insert(l).select();if(m)throw m;return o||[]}async function he(i){const{data:a,error:l}=await $.from("project_requirements").select("*").eq("project_id",i).maybeSingle();if(l)throw l;return a}async function Nt(i,a={}){const{data:l,error:o}=await $.from("project_requirements").insert({project_id:i,priority_price:a.priority_price??3,priority_warranty:a.priority_warranty??3,priority_efficiency:a.priority_efficiency??3,priority_timeline:a.priority_timeline??3,priority_reputation:a.priority_reputation??3,timeline_urgency:a.timeline_urgency??"flexible",specific_concerns:a.specific_concerns??[],must_have_features:a.must_have_features??[],nice_to_have_features:a.nice_to_have_features??[],...a}).select().single();if(o)throw o;return l}async function vt(i,a){const{data:l,error:o}=await $.from("project_requirements").update({...a,updated_at:new Date().toISOString()}).eq("project_id",i).select().maybeSingle();if(o)throw o;return l}async function St(i,a){if(await he(i)){const o=await vt(i,{...a,completed_at:new Date().toISOString()});if(!o)throw new Error("Failed to update requirements");return o}return Nt(i,{...a,completed_at:new Date().toISOString()})}const Ct=[{bid:{contractor_name:"Bay Area Heat Pump Pros",contractor_company:"Bay Area Heat Pump Pros LLC",contractor_phone:"(415) 555-1234",contractor_email:"info@baheatpumppros.com",contractor_license:"CSLB #1234567",contractor_license_state:"CA",contractor_website:"https://baheatpumppros.com",contractor_years_in_business:15,contractor_google_rating:4.8,contractor_google_review_count:247,contractor_certifications:["NATE Certified","EPA 608","Carrier Factory Authorized"],contractor_is_switch_preferred:!0,total_bid_amount:18500,labor_cost:4500,equipment_cost:9800,materials_cost:1200,permit_cost:850,total_before_rebates:18500,estimated_rebates:3500,total_after_rebates:15e3,estimated_days:2,labor_warranty_years:2,equipment_warranty_years:10,deposit_required:3700,deposit_percentage:20,financing_offered:!0,financing_terms:"0% APR for 24 months through GreenSky",scope_summary:"Complete heat pump system installation with panel upgrade",inclusions:["Remove existing gas furnace and AC","Install Carrier Infinity 26 heat pump","Install new air handler","Install Infinity Touch thermostat","200A electrical panel upgrade","Permits and inspections","System commissioning","Homeowner training"],exclusions:["Ductwork modifications","Drywall repair","Landscaping restoration"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Carrier",model_number:"25VNA836A003",model_name:"Infinity 26 Heat Pump",capacity_btu:36e3,capacity_tons:3,seer_rating:26,seer2_rating:24.5,hspf_rating:13,hspf2_rating:10.5,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:51,voltage:240,energy_star_certified:!0,energy_star_most_efficient:!0,equipment_cost:7200,confidence:"high"},{equipment_type:"indoor_unit",brand:"Carrier",model_number:"FV4CNB003",model_name:"Infinity Series Air Handler",variable_speed:!0,equipment_cost:2600,confidence:"high"}],questions:[{question_text:"What is the exact start date availability?",question_category:"timeline",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Is the 10-year warranty transferable to a new homeowner?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Will you perform a Manual J load calculation before installation?",question_category:"scope",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What happens if the 200A panel upgrade reveals additional electrical issues?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Can you provide references from recent heat pump installations?",question_category:"credentials",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What commissioning tests will you perform after installation?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"How does the 0% APR financing work and are there any hidden fees?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What is your process if the system does not perform as expected?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0}]},{bid:{contractor_name:"GreenTech HVAC Solutions",contractor_company:"GreenTech HVAC Solutions Inc",contractor_phone:"(510) 555-9876",contractor_email:"sales@greentechhvac.com",contractor_license:"CSLB #9876543",contractor_license_state:"CA",contractor_website:"https://greentechhvac.com",contractor_years_in_business:8,contractor_google_rating:4.6,contractor_google_review_count:156,contractor_certifications:["NATE Certified","EPA 608","Mitsubishi Diamond Contractor"],contractor_is_switch_preferred:!1,total_bid_amount:16800,labor_cost:3800,equipment_cost:9200,materials_cost:1e3,permit_cost:750,total_before_rebates:16800,estimated_rebates:3200,total_after_rebates:13600,estimated_days:3,labor_warranty_years:1,equipment_warranty_years:12,deposit_required:5040,deposit_percentage:30,financing_offered:!0,financing_terms:"5.99% APR for 60 months",scope_summary:"Heat pump installation with existing electrical panel",inclusions:["Remove existing HVAC system","Install Mitsubishi heat pump","Install air handler","Ecobee smart thermostat","Permits and inspections","System startup"],exclusions:["Electrical panel upgrade (additional $2,500)","Ductwork modifications","Drywall repair"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Mitsubishi",model_number:"SUZ-KA36NAHZ",model_name:"Hyper-Heating INVERTER",capacity_btu:36e3,capacity_tons:3,seer_rating:20,seer2_rating:18.5,hspf_rating:12.5,hspf2_rating:10.2,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:48,voltage:230,energy_star_certified:!0,energy_star_most_efficient:!1,equipment_cost:6800,confidence:"high"},{equipment_type:"indoor_unit",brand:"Mitsubishi",model_number:"SVZ-KP36NA",model_name:"Multi-Position Air Handler",variable_speed:!0,equipment_cost:2400,confidence:"high"}],questions:[{question_text:"Will the existing electrical panel support the heat pump?",question_category:"scope",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Why is the labor warranty only 1 year?",question_category:"warranty",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What is included in the electrical panel upgrade if needed ($2,500)?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"Will you perform airflow measurements and duct testing?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is the cold weather performance of this Mitsubishi model?",question_category:"equipment",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Can you extend the labor warranty for an additional fee?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Why is the 30% deposit higher than typical?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What maintenance is required to keep the 12-year warranty valid?",question_category:"warranty",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Do you offer any post-installation support or maintenance plans?",question_category:"scope",priority:"low",is_answered:!1,auto_generated:!0}]},{bid:{contractor_name:"Comfort First Heating & Cooling",contractor_company:"Comfort First H&C",contractor_phone:"(408) 555-4321",contractor_email:"quotes@comfortfirst.com",contractor_license:"CSLB #5678901",contractor_license_state:"CA",contractor_years_in_business:22,contractor_google_rating:4.9,contractor_google_review_count:412,contractor_certifications:["NATE Certified","EPA 608","Lennox Premier Dealer","BPI Certified"],contractor_is_switch_preferred:!0,total_bid_amount:21500,labor_cost:5500,equipment_cost:11500,materials_cost:1500,permit_cost:950,total_before_rebates:21500,estimated_rebates:4e3,total_after_rebates:17500,estimated_days:2,labor_warranty_years:5,equipment_warranty_years:10,deposit_required:4300,deposit_percentage:20,financing_offered:!0,financing_terms:"0% APR for 36 months or 2.99% for 72 months",scope_summary:"Premium installation with load calculation and duct sealing",inclusions:["Manual J load calculation","Remove existing system","Install Lennox XP25 heat pump","Install air handler with ECM motor","iComfort S30 smart thermostat","Electrical circuit upgrade","Duct sealing and testing","Permits and inspections","Professional commissioning","First year maintenance included"],exclusions:["Full ductwork replacement","Drywall repair"],extraction_confidence:"high",verified_by_user:!1,is_favorite:!1},equipment:[{equipment_type:"outdoor_unit",brand:"Lennox",model_number:"XP25-036-230",model_name:"XP25 Variable Capacity Heat Pump",capacity_btu:36e3,capacity_tons:3,seer_rating:25.5,seer2_rating:23.5,hspf_rating:11.5,hspf2_rating:9.8,variable_speed:!0,stages:99,refrigerant_type:"R-410A",sound_level_db:59,voltage:230,energy_star_certified:!0,energy_star_most_efficient:!0,equipment_cost:8500,confidence:"high"},{equipment_type:"indoor_unit",brand:"Lennox",model_number:"CBX40UHV-036",model_name:"Variable Speed Air Handler",variable_speed:!0,equipment_cost:3e3,confidence:"high"}],questions:[{question_text:"What does the Manual J load calculation include?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is the justification for the higher price compared to other bids?",question_category:"pricing",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What does the 5-year labor warranty cover specifically?",question_category:"warranty",priority:"high",is_answered:!1,auto_generated:!0},{question_text:"What does the duct sealing and testing process involve?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What is included in the first year maintenance?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"How does the XP25 compare to the Carrier Infinity 26 in cold weather?",question_category:"equipment",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"What is the sound level of this equipment compared to my current system?",question_category:"equipment",priority:"low",is_answered:!1,auto_generated:!0},{question_text:"Can you walk me through the professional commissioning process?",question_category:"scope",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"What happens after the first year of maintenance - what are ongoing costs?",question_category:"pricing",priority:"medium",is_answered:!1,auto_generated:!0},{question_text:"Are there any additional rebates you can help me apply for?",question_category:"pricing",priority:"low",is_answered:!1,auto_generated:!0}]}],kt=[{program_name:"Federal 25C Tax Credit",program_code:"FED-25C",description:"Tax credit for energy efficient home improvements",program_type:"federal",available_nationwide:!0,rebate_percentage:30,max_rebate:2e3,income_qualified:!1,stackable:!0,is_active:!0},{program_name:"BayREN Home+ Rebate",program_code:"BAYREN-HP",description:"Bay Area regional heat pump rebate program",program_type:"utility",available_states:["CA"],rebate_amount:1500,income_qualified:!1,stackable:!0,is_active:!0}];function It({user:i,onSelectProject:a,onCreateProject:l}){const[o,m]=j.useState([]),[d,w]=j.useState(!0),[C,P]=j.useState(!1),[v,c]=j.useState(!1);j.useEffect(()=>{S()},[i.id]);async function S(){try{const x=await Te(i.id);m(x)}catch(x){console.error("Failed to load projects:",x)}finally{w(!1)}}async function q(){c(!0);try{const x=await ge(i.id,{project_name:"My Heat Pump Project",status:"collecting_bids"});l(x.id)}catch(x){console.error("Failed to create project:",x)}finally{c(!1)}}async function f(){P(!0);try{const x=await ge(i.id,{project_name:"Demo: Heat Pump Comparison",status:"collecting_bids",heat_pump_type:"air_source",system_size_tons:3});await $.from("project_requirements").insert({project_id:x.id,priority_price:4,priority_warranty:3,priority_efficiency:4,priority_timeline:2,priority_reputation:5,timeline_urgency:"within_month",specific_concerns:["Energy efficiency","Long-term reliability"],must_have_features:["Variable speed compressor","Smart thermostat compatible"],nice_to_have_features:["Low noise operation"],completed_at:new Date().toISOString()});for(const _ of Ct){const k=await _t(x.id,_.bid);if(_.equipment.length>0&&await wt(k.id,_.equipment),_.questions.length>0){const n=_.questions.map((g,h)=>({bid_id:k.id,...g,display_order:h}));await $.from("bid_questions").insert(n)}}for(const _ of kt){const{data:k}=await $.from("rebate_programs").select("id").eq("program_code",_.program_code).maybeSingle();k||await $.from("rebate_programs").insert(_)}l(x.id)}catch(x){console.error("Failed to create demo project:",x)}finally{P(!1)}}function b(x){return new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}function y(x){const _={draft:{label:"Draft",className:"bg-gray-100 text-gray-600"},collecting_bids:{label:"Gathering Bids",className:"bg-blue-100 text-blue-700"},analyzing:{label:"Analyzing",className:"bg-amber-100 text-amber-700"},comparing:{label:"Comparing",className:"bg-switch-green-100 text-switch-green-700"},decided:{label:"Decision Made",className:"bg-switch-green-100 text-switch-green-700"},completed:{label:"Completed",className:"bg-gray-100 text-gray-600"}},k=_[x]||_.draft;return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${k.className}`,children:k.label})}return d?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-switch-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading your projects..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-12",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome to BidSmart"}),e.jsx("p",{className:"text-gray-600",children:"Compare heat pump bids with confidence."}),i.email&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Signed in as ",e.jsx("span",{className:"font-medium",children:i.email})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("button",{onClick:q,disabled:v,className:"w-full bg-white rounded-xl border border-gray-200 p-5 flex items-center gap-4 hover:border-switch-green-400 hover:bg-switch-green-50 transition-colors text-left group",children:[e.jsx("div",{className:"w-12 h-12 bg-switch-green-100 rounded-full flex items-center justify-center group-hover:bg-switch-green-200 transition-colors",children:e.jsx(Me,{className:"w-6 h-6 text-switch-green-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Start New Project"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Upload your bids and get started"})]}),e.jsx(se,{className:"w-5 h-5 text-gray-400 group-hover:text-switch-green-600"})]}),e.jsxs("button",{onClick:f,disabled:C,className:"w-full bg-white rounded-xl border border-gray-200 p-5 flex items-center gap-4 hover:border-blue-400 hover:bg-blue-50 transition-colors text-left group",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:e.jsx(pt,{className:"w-6 h-6 text-blue-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:C?"Loading Demo...":"Try Demo Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Explore with sample bid data"})]}),e.jsx(se,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600"})]})]}),o.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(xt,{className:"w-5 h-5 text-gray-400"}),"Your Projects"]}),e.jsx("div",{className:"space-y-3",children:o.map(x=>e.jsxs("button",{onClick:()=>a(x.id),className:"w-full bg-white rounded-xl border border-gray-200 p-4 flex items-center gap-4 hover:border-gray-300 hover:shadow-sm transition-all text-left group",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(me,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:x.project_name}),y(x.status)]}),e.jsx("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-3.5 h-3.5"}),b(x.created_at)]})})]}),e.jsx(se,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]},x.id))})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsx("p",{className:"text-xs text-gray-400",children:"Powered by TheSwitchIsOn.org"})})]})})}const Pt={1:"GATHER",2:"COMPARE",3:"DECIDE",4:"VERIFY"},We=j.createContext(null),Le="bidsmart_phase_state";function qt(){try{const i=localStorage.getItem(Le);if(i)return JSON.parse(i)}catch{}return null}function ce(i){try{localStorage.setItem(Le,JSON.stringify(i))}catch{}}function At({children:i,userId:a,initialProjectId:l}){const[o,m]=j.useState({currentPhase:1,phaseStatus:{1:"active",2:"locked",3:"locked",4:"locked"},projectId:null,project:null,bids:[],requirements:null,questions:[],loading:!0,error:null});j.useEffect(()=>{async function f(){try{const b=qt(),y=await Te(a);let x,_;if(l){const D=y.find(G=>G.id===l);if(D)x=l,_=D;else throw new Error("Project not found")}else b!=null&&b.projectId&&y.find(D=>D.id===b.projectId)?(x=b.projectId,_=y.find(D=>D.id===b.projectId)):y.length>0?(_=y[0],x=_.id):(_=await ge(a,{project_name:"My Heat Pump Project",status:"collecting_bids"}),x=_.id);const k=await Ne(x),n=await Promise.all(k.map(async D=>({bid:D,equipment:await ve(D.id)}))),g=await he(x),{data:h}=await $.from("bid_questions").select("*").in("bid_id",k.map(D=>D.id)).order("display_order",{ascending:!0});let M=1,B={1:"active",2:"locked",3:"locked",4:"locked"};b&&b.projectId===x?(M=b.currentPhase,B=b.phaseStatus):n.length>=2&&(g!=null&&g.completed_at)&&(B[1]="completed",B[2]="active",B[3]="active",B[4]="active",M=2),m({currentPhase:M,phaseStatus:B,projectId:x,project:_,bids:n,requirements:g,questions:h||[],loading:!1,error:null}),ce({currentPhase:M,projectId:x,phaseStatus:B})}catch(b){console.error("Failed to initialize project:",b),m(y=>({...y,loading:!1,error:"Failed to load project data"}))}}f()},[a,l]);const d=j.useCallback(f=>o.phaseStatus[f]!=="locked",[o.phaseStatus]),w=j.useCallback(f=>{d(f)&&m(b=>{const y={...b,currentPhase:f};return ce({currentPhase:f,projectId:b.projectId,phaseStatus:b.phaseStatus}),y})},[d]),C=j.useCallback(f=>{m(b=>{const y={...b.phaseStatus};if(y[f]="completed",f===1)y[2]="active",y[3]="active",y[4]="active";else{const k=f+1;k<=4&&y[k]==="locked"&&(y[k]="active")}const x=f+1,_=x<=4?x:f;return ce({currentPhase:_,projectId:b.projectId,phaseStatus:y}),{...b,currentPhase:_,phaseStatus:y}})},[]),P=j.useCallback(async()=>{if(!o.projectId)return;const f=await Ne(o.projectId),b=await Promise.all(f.map(async y=>({bid:y,equipment:await ve(y.id)})));m(y=>({...y,bids:b}))},[o.projectId]),v=j.useCallback(async()=>{if(!o.projectId)return;const f=await he(o.projectId);m(b=>({...b,requirements:f}))},[o.projectId]),c=j.useCallback(async()=>{if(!o.projectId||o.bids.length===0)return;const{data:f}=await $.from("bid_questions").select("*").in("bid_id",o.bids.map(b=>b.bid.id)).order("display_order",{ascending:!0});m(b=>({...b,questions:f||[]}))},[o.projectId,o.bids]),S=j.useCallback(f=>Pt[f],[]),q={...o,goToPhase:w,completePhase:C,canAccessPhase:d,refreshBids:P,refreshRequirements:v,refreshQuestions:c,getPhaseLabel:S};return e.jsx(We.Provider,{value:q,children:i})}function Q(){const i=j.useContext(We);if(!i)throw new Error("usePhase must be used within a PhaseProvider");return i}const Se=[{phase:1,label:"GATHER"},{phase:2,label:"COMPARE"},{phase:3,label:"DECIDE"},{phase:4,label:"VERIFY"}];function $t({children:i}){const{currentPhase:a,phaseStatus:l,goToPhase:o,canAccessPhase:m}=Q();return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:Se.map((d,w)=>{const C=l[d.phase],P=a===d.phase,v=m(d.phase);return e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("button",{onClick:()=>v&&o(d.phase),disabled:!v,className:`
                      flex items-center gap-2 transition-all
                      ${v?"cursor-pointer":"cursor-not-allowed"}
                      ${P?"opacity-100":v?"opacity-70 hover:opacity-100":"opacity-40"}
                    `,children:[e.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold transition-colors
                        ${C==="completed"?"bg-switch-green-600 text-white":""}
                        ${C==="active"&&P?"bg-switch-green-600 text-white":""}
                        ${C==="active"&&!P?"bg-switch-green-100 text-switch-green-700 border-2 border-switch-green-600":""}
                        ${C==="locked"?"bg-gray-200 text-gray-400":""}
                      `,children:C==="completed"?e.jsx(Re,{className:"w-4 h-4"}):d.phase}),e.jsx("span",{className:`
                        text-sm font-medium hidden sm:block
                        ${P?"text-gray-900":"text-gray-500"}
                      `,children:d.label})]}),w<Se.length-1&&e.jsx("div",{className:"flex-1 mx-3",children:e.jsx("div",{className:`
                          h-0.5 transition-colors
                          ${l[w+2]!=="locked"||l[w+1]==="completed"?"bg-switch-green-600":"bg-gray-200"}
                        `})})]},d.phase)})}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"h-1 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-switch-green-600 transition-all duration-500",style:{width:`${(a-1)/3*100+(l[a]==="completed"?25:0)}%`}})})})]})}),e.jsx("main",{className:"flex-1 max-w-4xl w-full mx-auto px-4 py-6",children:i})]})}function Z({label:i,value:a,onChange:l,description:o}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:i}),e.jsxs("span",{className:"text-sm text-gray-500",children:[a,"/5"]})]}),e.jsx("input",{type:"range",min:"1",max:"5",value:a,onChange:m=>l(parseInt(m.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-switch-green-600"}),e.jsx("p",{className:"text-xs text-gray-500",children:o})]})}function Ce(){const{projectId:i,bids:a,requirements:l,completePhase:o,refreshRequirements:m}=Q(),[d,w]=j.useState({price:(l==null?void 0:l.priority_price)??3,efficiency:(l==null?void 0:l.priority_efficiency)??3,warranty:(l==null?void 0:l.priority_warranty)??3,reputation:(l==null?void 0:l.priority_reputation)??3,timeline:(l==null?void 0:l.priority_timeline)??3}),[C,P]=j.useState(!1),[v,c]=j.useState(!1);j.useEffect(()=>{l&&w({price:l.priority_price??3,efficiency:l.priority_efficiency??3,warranty:l.priority_warranty??3,reputation:l.priority_reputation??3,timeline:l.priority_timeline??3})},[l]);const q=a.filter(n=>n.bid.total_bid_amount>0&&n.bid.contractor_name).length>=2,f=n=>{n.preventDefault(),n.stopPropagation(),n.type==="dragenter"||n.type==="dragover"?c(!0):n.type==="dragleave"&&c(!1)},b=n=>{n.preventDefault(),n.stopPropagation(),c(!1)},y=async()=>{if(!(!i||!q)){P(!0);try{await St(i,{priority_price:d.price,priority_efficiency:d.efficiency,priority_warranty:d.warranty,priority_reputation:d.reputation,priority_timeline:d.timeline}),await m(),o(1)}catch(n){console.error("Failed to save requirements:",n)}finally{P(!1)}}},x=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),_=n=>n.bid.total_bid_amount>0?e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}):e.jsx(fe,{className:"w-5 h-5 text-amber-500"}),k=n=>n.bid.total_bid_amount>0?"Ready":"Processing";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gather Your Bids"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Upload at least 2 contractor bids to compare, then tell us what matters most to you."})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(jt,{className:"w-5 h-5 text-switch-green-600"}),"Upload Your Bids"]}),e.jsxs("div",{onDragEnter:f,onDragLeave:f,onDragOver:f,onDrop:b,className:`
            border-2 border-dashed rounded-xl p-8 text-center transition-colors
            ${v?"border-switch-green-500 bg-switch-green-50":"border-gray-300 hover:border-gray-400"}
          `,children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(me,{className:"w-6 h-6 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Drag and drop PDF bid documents here"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"or"}),e.jsx("button",{className:"btn btn-secondary",children:"Browse Files"}),e.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Supported formats: PDF (max 10MB each)"})]}),a.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Uploaded Bids (",a.length,")"]}),a.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:n.bid.contractor_name||n.bid.contractor_company||"Unknown Contractor"}),e.jsx("p",{className:"text-sm text-gray-500",children:n.bid.total_bid_amount>0?x(n.bid.total_bid_amount):"Processing..."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm ${n.bid.total_bid_amount>0?"text-switch-green-600":"text-amber-500"}`,children:k(n)}),_(n)]})]},n.bid.id))]}),e.jsxs("button",{className:"btn btn-secondary w-full mt-4 flex items-center justify-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"Add Another Bid"]}),a.length<2&&e.jsxs("div",{className:"mt-4 flex items-start gap-2 text-amber-600 bg-amber-50 rounded-lg p-3",children:[e.jsx(nt,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm",children:["You need at least 2 bids to compare. ",a.length===0?"Upload your first bid to get started.":"Upload 1 more bid to continue."]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"What Matters Most to You?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Adjust these sliders to reflect your priorities. We will use these to highlight the best options for you."}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{label:"Upfront Cost",value:d.price,onChange:n=>w(g=>({...g,price:n})),description:"How important is getting the lowest price?"}),e.jsx(Z,{label:"Energy Efficiency / Long-term Savings",value:d.efficiency,onChange:n=>w(g=>({...g,efficiency:n})),description:"Higher efficiency means lower utility bills over time"}),e.jsx(Z,{label:"Warranty Length",value:d.warranty,onChange:n=>w(g=>({...g,warranty:n})),description:"Longer warranties provide peace of mind"}),e.jsx(Z,{label:"Contractor Reputation",value:d.reputation,onChange:n=>w(g=>({...g,reputation:n})),description:"Experience, reviews, and certifications"}),e.jsx(Z,{label:"Installation Timeline",value:d.timeline,onChange:n=>w(g=>({...g,timeline:n})),description:"How quickly can they complete the work?"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:y,disabled:!q||C,className:"btn btn-primary flex items-center gap-2 px-6",children:[C?"Saving...":"Continue to Compare",e.jsx(pe,{className:"w-4 h-4"})]})}),!q&&e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Upload at least 2 bids to continue"})]})}const re="200px",ke="180px";function Dt(){var H,z;const{bids:i,requirements:a,completePhase:l}=Q(),[o,m]=j.useState("equipment"),[d,w]=j.useState(!1),[C,P]=j.useState(!1),[v,c]=j.useState(!1),S=t=>t?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"-",q=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-",f=(t,r=!0)=>{const A=t.filter(R=>R!=null);return A.length===0?null:r?Math.max(...A):Math.min(...A)},b=(t,r)=>t==null||r==null?!1:t===r,y=[{key:"equipment",label:"Equipment",description:"Specs, efficiency ratings, and features",icon:e.jsx(Be,{className:"w-5 h-5"})},{key:"contractors",label:"Contractors",description:"Experience, ratings, and certifications",icon:e.jsx(De,{className:"w-5 h-5"})},{key:"costs",label:"Costs",description:"Pricing, warranties, and inclusions",icon:e.jsx(Ee,{className:"w-5 h-5"})}],x=()=>i.map(t=>{const r=t.equipment.find(A=>A.equipment_type==="outdoor_unit"||A.equipment_type==="heat_pump")||t.equipment[0];return{bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",brand:(r==null?void 0:r.brand)||"-",model:(r==null?void 0:r.model_number)||(r==null?void 0:r.model_name)||"-",seer2:(r==null?void 0:r.seer2_rating)||(r==null?void 0:r.seer_rating),hspf2:(r==null?void 0:r.hspf2_rating)||(r==null?void 0:r.hspf_rating),capacityTons:r==null?void 0:r.capacity_tons,capacityBtu:r==null?void 0:r.capacity_btu,variableSpeed:r==null?void 0:r.variable_speed,soundLevel:r==null?void 0:r.sound_level_db,energyStar:r==null?void 0:r.energy_star_certified,energyStarMostEfficient:r==null?void 0:r.energy_star_most_efficient,refrigerantType:r==null?void 0:r.refrigerant_type,voltage:r==null?void 0:r.voltage,stages:r==null?void 0:r.stages,cop:r==null?void 0:r.cop,eer:r==null?void 0:r.eer_rating,compressorWarranty:r==null?void 0:r.compressor_warranty_years}}),_=()=>i.map(t=>({bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",yearsInBusiness:t.bid.contractor_years_in_business,yearEstablished:t.bid.contractor_year_established,googleRating:t.bid.contractor_google_rating,reviewCount:t.bid.contractor_google_review_count,certifications:t.bid.contractor_certifications||[],license:t.bid.contractor_license,licenseState:t.bid.contractor_license_state,insuranceVerified:t.bid.contractor_insurance_verified,isSwitchPreferred:t.bid.contractor_is_switch_preferred,phone:t.bid.contractor_phone,email:t.bid.contractor_email,website:t.bid.contractor_website,totalInstalls:t.bid.contractor_total_installs})),k=()=>i.map(t=>({bidId:t.bid.id,contractor:t.bid.contractor_name||t.bid.contractor_company||"Unknown",totalAmount:t.bid.total_bid_amount,equipmentCost:t.bid.equipment_cost,laborCost:t.bid.labor_cost,materialsCost:t.bid.materials_cost,permitCost:t.bid.permit_cost,laborWarranty:t.bid.labor_warranty_years,equipmentWarranty:t.bid.equipment_warranty_years,financingAvailable:t.bid.financing_offered,financingTerms:t.bid.financing_terms,inclusions:t.bid.inclusions||[],exclusions:t.bid.exclusions||[],estimatedDays:t.bid.estimated_days,startDateAvailable:t.bid.start_date_available,validUntil:t.bid.valid_until,bidDate:t.bid.bid_date,depositRequired:t.bid.deposit_required,depositPercentage:t.bid.deposit_percentage,paymentSchedule:t.bid.payment_schedule})),n=x(),g=_(),h=k(),M=f(n.map(t=>t.seer2)),B=f(n.map(t=>t.hspf2)),D=f(g.map(t=>t.yearsInBusiness)),G=f(g.map(t=>t.googleRating)),T=f(h.map(t=>t.totalAmount),!1),V=f(h.map(t=>t.laborWarranty)),K=f(h.map(t=>t.equipmentWarranty)),ee=f(h.map(t=>t.estimatedDays),!1),ne=()=>{if(!a||i.length===0)return null;let t=null,r=-1;i.forEach(R=>{const U=n.find(W=>W.bidId===R.bid.id),L=h.find(W=>W.bidId===R.bid.id),E=g.find(W=>W.bidId===R.bid.id);let Y=0;if(L!=null&&L.totalAmount&&T){const W=T/L.totalAmount*a.priority_price;Y+=W}if(U!=null&&U.seer2&&M){const W=U.seer2/M*a.priority_efficiency;Y+=W}if(L!=null&&L.laborWarranty&&V){const W=L.laborWarranty/V*a.priority_warranty;Y+=W}if(E!=null&&E.googleRating&&G){const W=E.googleRating/G*a.priority_reputation;Y+=W}Y>r&&(r=Y,t=R.bid.id)});const A=i.find(R=>R.bid.id===t);return A?{contractor:A.bid.contractor_name||A.bid.contractor_company||"Unknown",reason:oe(A.bid.id)}:null},oe=t=>{const r=[],A=h.find(U=>U.bidId===t),R=n.find(U=>U.bidId===t);return(A==null?void 0:A.totalAmount)===T&&r.push("lowest price"),(R==null?void 0:R.seer2)===M&&r.push("highest efficiency"),(A==null?void 0:A.laborWarranty)===V&&V&&V>1&&r.push("best warranty"),r.length===0&&r.push("best overall balance of your priorities"),`Based on your priorities, this bid offers the ${r.join(", ")}.`},J=ne(),le=()=>{l(2)},s=i.length,N=`calc(${re} + (${s} * ${ke}))`,p={width:re,minWidth:re,maxWidth:re},u={minWidth:ke};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Compare Your Bids"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review the equipment, contractors, and costs side by side."})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-6",children:y.map((t,r)=>e.jsxs("button",{onClick:()=>m(t.key),className:`
              relative p-4 rounded-xl text-left transition-all duration-200 border-2
              ${o===t.key?"bg-gradient-to-br from-switch-green-50 to-switch-green-100 border-switch-green-500 shadow-md":"bg-white border-gray-200 hover:border-gray-300 hover:shadow-sm"}
            `,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`
                w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0
                ${o===t.key?"bg-switch-green-600 text-white":"bg-gray-100 text-gray-500"}
              `,children:t.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`
                    text-xs font-medium px-2 py-0.5 rounded-full
                    ${o===t.key?"bg-switch-green-600 text-white":"bg-gray-200 text-gray-600"}
                  `,children:[r+1," of 3"]})}),e.jsx("h3",{className:`
                  font-semibold mt-1
                  ${o===t.key?"text-switch-green-800":"text-gray-900"}
                `,children:t.label}),e.jsx("p",{className:`
                  text-sm mt-0.5
                  ${o===t.key?"text-switch-green-700":"text-gray-500"}
                `,children:t.description})]})]}),o===t.key&&e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2",children:e.jsx("div",{className:"w-3 h-3 bg-switch-green-500 rotate-45"})})]},t.key))}),e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:`
          px-5 py-3 border-b-2 border-gray-200 flex items-center gap-3
          bg-gradient-to-r from-switch-green-600 to-switch-green-700
        `,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center text-white",children:(H=y.find(t=>t.key===o))==null?void 0:H.icon}),e.jsxs("h2",{className:"font-semibold text-white",children:[(z=y.find(t=>t.key===o))==null?void 0:z.label," Comparison"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",style:{minWidth:N,tableLayout:"fixed"},children:[o==="equipment"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Specification"}),n.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<n.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Manufacturer & Model"}),n.map((t,r)=>e.jsxs("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<n.length-1?"border-r border-gray-100":""}`,children:[t.brand," ",t.model]},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"SEER2 Rating"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.seer2,M)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<n.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.seer2||"-",b(t.seer2,M)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"HSPF2 Rating"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.hspf2,B)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<n.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.hspf2||"-",b(t.hspf2,B)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Capacity (tons)"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.capacityTons||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Variable Speed"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<n.length-1?"border-r border-gray-100":""}`,children:t.variableSpeed?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(O,{className:"w-5 h-5"})," Yes"]}):t.variableSpeed===!1?e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Sound Level (dB)"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.soundLevel||"-"},t.bidId))]}),e.jsxs("tr",{className:d?"border-b border-gray-200":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"ENERGY STAR"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<n.length-1?"border-r border-gray-100":""}`,children:t.energyStar?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(O,{className:"w-5 h-5"})," Certified"]}):t.energyStar===!1?e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),d&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Capacity (BTU)"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.capacityBtu?t.capacityBtu.toLocaleString():"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Refrigerant Type"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.refrigerantType||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Voltage"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.voltage?`${t.voltage}V`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Stages"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.stages||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"COP Rating"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.cop||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"EER Rating"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.eer||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Compressor Warranty"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<n.length-1?"border-r border-gray-100":""}`,children:t.compressorWarranty?`${t.compressorWarranty} years`:"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Most Efficient"}),n.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<n.length-1?"border-r border-gray-100":""}`,children:t.energyStarMostEfficient?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(O,{className:"w-5 h-5"})," Yes"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]})]})]})]}),o==="contractors"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Information"}),g.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<g.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Years in Business"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.yearsInBusiness,D)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<g.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.yearsInBusiness?`${t.yearsInBusiness} years`:"-",b(t.yearsInBusiness,D)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," MOST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Google Rating"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.googleRating,G)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<g.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.googleRating?e.jsxs("span",{className:"flex items-center gap-1",children:[t.googleRating,e.jsx(F,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"})]}):"-",b(t.googleRating,G)&&e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:"TOP"})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Review Count"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.reviewCount?`${t.reviewCount} reviews`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Certifications"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.certifications.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.certifications.slice(0,3).map((A,R)=>e.jsx("span",{className:"inline-flex px-2 py-0.5 bg-gray-100 text-gray-700 text-xs font-medium rounded",children:A},R)),t.certifications.length>3&&e.jsxs("span",{className:"inline-flex px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded",children:["+",t.certifications.length-3]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"License Number"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.license||e.jsx("span",{className:"text-gray-400",children:"Not provided"})},t.bidId))]}),e.jsxs("tr",{className:C?"border-b border-gray-200 bg-gray-50/50":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Switch Preferred"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<g.length-1?"border-r border-gray-100":""}`,children:t.isSwitchPreferred?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-gradient-to-r from-switch-green-500 to-switch-green-600 text-white rounded-full text-xs font-semibold shadow-sm",children:[e.jsx(O,{className:"w-3.5 h-3.5"})," Preferred Partner"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),C&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Phone"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.phone||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Email"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.email?e.jsx("a",{href:`mailto:${t.email}`,className:"text-switch-green-600 hover:underline truncate block",children:t.email}):"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Website"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.website?e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-switch-green-600 hover:underline truncate block",children:t.website.replace(/^https?:\/\//,"")}):"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"License State"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.licenseState||"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Insurance Verified"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<g.length-1?"border-r border-gray-100":""}`,children:t.insuranceVerified?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700",children:[e.jsx(O,{className:"w-4 h-4"})," Verified"]}):e.jsx("span",{className:"text-gray-400",children:"-"})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Year Established"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.yearEstablished||"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Total Installs"}),g.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<g.length-1?"border-r border-gray-100":""}`,children:t.totalInstalls?t.totalInstalls.toLocaleString():"-"},t.bidId))]})]})]})]}),o==="costs"&&e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-900",children:[e.jsx("th",{style:p,className:"px-5 py-4 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider border-r border-gray-700",children:"Cost Item"}),h.map((t,r)=>e.jsx("th",{style:u,className:`px-5 py-4 text-left text-sm font-semibold text-white ${r<h.length-1?"border-r border-gray-700":""}`,children:t.contractor},t.bidId))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:[e.jsx("td",{style:p,className:"px-5 py-5 text-sm font-bold text-gray-900 bg-gray-100 border-r border-gray-200",children:"Total Bid Amount"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-5 ${b(t.totalAmount,T)?"bg-gradient-to-r from-switch-green-50 to-switch-green-100":""} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xl font-bold ${b(t.totalAmount,T)?"text-switch-green-700":"text-gray-900"}`,children:S(t.totalAmount)}),b(t.totalAmount,T)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," LOWEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Equipment Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:S(t.equipmentCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Labor Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:S(t.laborCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Labor Warranty"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.laborWarranty,V)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.laborWarranty?`${t.laborWarranty} years`:"-",b(t.laborWarranty,V)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Equipment Warranty"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm font-semibold ${b(t.equipmentWarranty,K)?"text-switch-green-700 bg-gradient-to-r from-switch-green-50 to-switch-green-100":"text-gray-900"} ${r<h.length-1?"border-r border-gray-100":""}`,children:e.jsxs("span",{className:"flex items-center gap-2",children:[t.equipmentWarranty?`${t.equipmentWarranty} years`:"-",b(t.equipmentWarranty,K)&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," BEST"]})]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"Financing Available"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm ${r<h.length-1?"border-r border-gray-100":""}`,children:t.financingAvailable?e.jsxs("span",{className:"inline-flex items-center gap-1 text-switch-green-700 font-medium",children:[e.jsx(O,{className:"w-5 h-5"})," Available"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-400",children:[e.jsx(te,{className:"w-5 h-5"})," No"]})},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"What is Included"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.inclusions.length>0?e.jsxs("ul",{className:"text-xs space-y-1.5",children:[t.inclusions.slice(0,4).map((A,R)=>e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(O,{className:"w-3.5 h-3.5 text-switch-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:A})]},R)),t.inclusions.length>4&&e.jsxs("li",{className:"text-gray-500 pl-5",children:["+",t.inclusions.length-4," more items"]})]}):e.jsx("span",{className:"text-gray-400",children:"Not specified"})},t.bidId))]}),e.jsxs("tr",{className:v?"border-b border-gray-200 bg-gray-50/50":"",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-700 bg-gray-50 border-r border-gray-200",children:"What is NOT Included"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-900 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.exclusions.length>0?e.jsxs("ul",{className:"text-xs space-y-1.5",children:[t.exclusions.slice(0,4).map((A,R)=>e.jsxs("li",{className:"flex items-start gap-1.5",children:[e.jsx(te,{className:"w-3.5 h-3.5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:A})]},R)),t.exclusions.length>4&&e.jsxs("li",{className:"text-gray-500 pl-5",children:["+",t.exclusions.length-4," more items"]})]}):e.jsx("span",{className:"text-gray-400",children:"Not specified"})},t.bidId))]}),v&&e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Estimated Duration"}),h.map((t,r)=>e.jsxs("td",{style:u,className:`px-5 py-4 text-sm ${b(t.estimatedDays,ee)?"text-switch-green-700 font-semibold":"text-gray-600"} ${r<h.length-1?"border-r border-gray-100":""}`,children:[t.estimatedDays?`${t.estimatedDays} days`:"-",b(t.estimatedDays,ee)&&t.estimatedDays&&e.jsx("span",{className:"ml-2 inline-flex items-center gap-1 px-2 py-0.5 bg-switch-green-600 text-white text-xs font-medium rounded-full",children:"FASTEST"})]},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Available Start Date"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:q(t.startDateAvailable)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Quote Valid Until"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:q(t.validUntil)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Bid Date"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:q(t.bidDate)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Materials Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:S(t.materialsCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Permit Cost"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:S(t.permitCost)},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Deposit Required"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.depositRequired?S(t.depositRequired):t.depositPercentage?`${t.depositPercentage}%`:"-"},t.bidId))]}),e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Payment Schedule"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.paymentSchedule||"-"},t.bidId))]}),e.jsxs("tr",{children:[e.jsx("td",{style:p,className:"px-5 py-4 text-sm font-medium text-gray-500 bg-gray-50 border-r border-gray-200",children:"Financing Terms"}),h.map((t,r)=>e.jsx("td",{style:u,className:`px-5 py-4 text-sm text-gray-600 ${r<h.length-1?"border-r border-gray-100":""}`,children:t.financingTerms||"-"},t.bidId))]})]})]})]})]})}),e.jsx("div",{className:"px-5 py-3 bg-gray-50 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{o==="equipment"&&w(!d),o==="contractors"&&P(!C),o==="costs"&&c(!v)},className:"flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:o==="equipment"&&d||o==="contractors"&&C||o==="costs"&&v?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4"}),"Show More Details"]})})})]}),J&&e.jsx("div",{className:"bg-switch-green-50 border border-switch-green-200 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-switch-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(F,{className:"w-5 h-5 text-switch-green-700"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-switch-green-900",children:["Recommended: ",J.contractor]}),e.jsx("p",{className:"text-sm text-switch-green-700 mt-1",children:J.reason})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:le,className:"btn btn-primary flex items-center gap-2 px-6",children:["Continue to Decide",e.jsx(pe,{className:"w-4 h-4"})]})})]})}function Rt({rebatePrograms:i,selectedIncentives:a,onToggleIncentive:l}){const[o,m]=j.useState(new Set),d=c=>{const S=new Set(o);S.has(c)?S.delete(c):S.add(c),m(S)},w=c=>c?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(c):"-",C=c=>c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null,P=c=>c.max_rebate||c.rebate_amount||0,v=Array.from(a).reduce((c,S)=>{const q=i.find(f=>f.id===S);return c+(q?P(q):0)},0);return i.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-switch-green-600 to-switch-green-700 px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white text-lg",children:"Available Rebates & Incentives"}),e.jsx("p",{className:"text-switch-green-100 text-sm",children:"Select the incentives you plan to apply for"})]})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:i.map(c=>{const S=o.has(c.id),q=a.has(c.id),f=P(c);return e.jsxs("div",{className:q?"bg-switch-green-50/50":"",children:[e.jsxs("div",{className:"flex items-center gap-3 px-5 py-4",children:[e.jsx("button",{onClick:()=>d(c.id),className:"p-1 hover:bg-gray-100 rounded transition-colors",children:S?e.jsx(ie,{className:"w-5 h-5 text-gray-500"}):e.jsx(se,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:c.program_name}),c.program_type&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full",children:c.program_type}),c.income_qualified&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full",children:"Income Qualified"})]}),!S&&c.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5 truncate",children:c.description})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-lg font-bold text-switch-green-700",children:c.rebate_percentage?`Up to ${c.rebate_percentage}%`:w(f)}),c.rebate_percentage&&c.max_rebate&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Max: ",w(c.max_rebate)]})]}),e.jsx("button",{onClick:()=>l(c.id),className:"p-1 hover:bg-gray-100 rounded transition-colors",children:q?e.jsx(lt,{className:"w-6 h-6 text-switch-green-600"}):e.jsx(ft,{className:"w-6 h-6 text-gray-400 hover:text-gray-600"})})]})]}),S&&e.jsxs("div",{className:"px-5 pb-5 pl-14 space-y-4",children:[c.description&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-700",children:c.description})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(c.valid_from||c.valid_until)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Valid Period"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[c.valid_from&&C(c.valid_from),c.valid_from&&c.valid_until&&" - ",c.valid_until&&C(c.valid_until),!c.valid_from&&!c.valid_until&&"Ongoing"]})]})]}),c.typical_processing_days&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Processing Time"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["~",c.typical_processing_days," days"]})]})]}),c.available_states&&c.available_states.length>0&&!c.available_nationwide&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Available In"}),e.jsx("p",{className:"text-sm text-gray-900",children:c.available_states.join(", ")})]})]}),c.available_nationwide&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Availability"}),e.jsx("p",{className:"text-sm text-gray-900",children:"Available Nationwide"})]})]})]}),c.application_process&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"How to Apply"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:c.application_process})]}),c.requirements&&Object.keys(c.requirements).length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase",children:"Requirements"}),e.jsx("ul",{className:"text-sm text-gray-700 mt-1 space-y-1",children:Object.entries(c.requirements).map(([b,y])=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("span",{children:String(y)})]},b))})]}),!c.stackable&&c.cannot_stack_with&&c.cannot_stack_with.length>0&&e.jsxs("div",{className:"text-sm text-amber-700 bg-amber-50 rounded-lg p-3",children:[e.jsx("span",{className:"font-medium",children:"Note:"})," Cannot be combined with: ",c.cannot_stack_with.join(", ")]}),c.application_url&&e.jsxs("a",{href:c.application_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-switch-green-600 hover:text-switch-green-700 font-medium",children:[e.jsx(mt,{className:"w-4 h-4"}),"View Application Details"]})]})]},c.id)})}),e.jsx("div",{className:"bg-gray-50 px-5 py-4 border-t-2 border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[a.size," of ",i.length," selected"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Estimated Total Savings"}),e.jsx("p",{className:"text-2xl font-bold text-switch-green-700",children:w(v)})]})]})})]})}function Et(){const{bids:i,questions:a,refreshQuestions:l,completePhase:o}=Q(),[m,d]=j.useState([]),[w,C]=j.useState(new Set),[P,v]=j.useState(null),[c,S]=j.useState(null),[q,f]=j.useState(new Set);j.useEffect(()=>{b()},[]);const b=async()=>{const{data:s}=await $.from("rebate_programs").select("*").eq("is_active",!0).order("program_name");s&&(d(s),C(new Set(s.map(N=>N.id))))},y=s=>{const N=new Set(w);N.has(s)?N.delete(s):N.add(s),C(N)},x=()=>Array.from(w).reduce((s,N)=>{const p=m.find(u=>u.id===N);return s+(p&&(Number(p.max_rebate)||Number(p.rebate_amount))||0)},0),_=s=>s?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s):"-",k=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null,n=async s=>{await $.from("bid_questions").update({is_answered:!s.is_answered,answered_at:s.is_answered?null:new Date().toISOString()}).eq("id",s.id),l()},g=s=>a.filter(N=>N.bid_id===s),h=(s,N)=>{const u=g(s).filter(z=>!z.is_answered),H=`Questions for ${N}:

${u.map((z,t)=>`${t+1}. ${z.question_text}`).join(`

`)}`;navigator.clipboard.writeText(H),S(s),setTimeout(()=>S(null),2e3)},M=s=>{switch(s){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},B=s=>{const N=new Set(q);N.has(s)?N.delete(s):N.add(s),f(N)},D=x(),T=i.map(s=>{const N=s.equipment.find(u=>u.equipment_type==="outdoor_unit"||u.equipment_type==="heat_pump")||s.equipment[0],p=s.bid.total_bid_amount-D;return{bidId:s.bid.id,contractor:s.bid.contractor_name||s.bid.contractor_company||"Unknown",totalAmount:s.bid.total_bid_amount,estimatedRebates:D,netCost:p,equipmentBrand:(N==null?void 0:N.brand)||"-",equipmentModel:(N==null?void 0:N.model_number)||(N==null?void 0:N.model_name)||"-",seer2:(N==null?void 0:N.seer2_rating)||(N==null?void 0:N.seer_rating),googleRating:s.bid.contractor_google_rating,reviewCount:s.bid.contractor_google_review_count,laborWarranty:s.bid.labor_warranty_years,equipmentWarranty:s.bid.equipment_warranty_years,isSwitchPreferred:s.bid.contractor_is_switch_preferred,phone:s.bid.contractor_phone,email:s.bid.contractor_email,website:s.bid.contractor_website,license:s.bid.contractor_license,licenseState:s.bid.contractor_license_state,insuranceVerified:s.bid.contractor_insurance_verified,yearsInBusiness:s.bid.contractor_years_in_business,totalInstalls:s.bid.contractor_total_installs,certifications:s.bid.contractor_certifications||[],estimatedDays:s.bid.estimated_days,startDateAvailable:s.bid.start_date_available,validUntil:s.bid.valid_until,bidDate:s.bid.bid_date,financingOffered:s.bid.financing_offered,financingTerms:s.bid.financing_terms,userNotes:s.bid.user_notes,isFavorite:s.bid.is_favorite,verifiedByUser:s.bid.verified_by_user,extractionConfidence:s.bid.extraction_confidence,valueScore:s.bid.value_score,qualityScore:s.bid.quality_score,completenessScore:s.bid.completeness_score}}),V=Math.min(...T.map(s=>s.totalAmount||1/0)),K=Math.min(...T.map(s=>s.netCost||1/0)),ee=Math.max(...T.map(s=>s.googleRating||0)),ne=Math.max(...T.map(s=>s.seer2||0)),oe=Math.max(...T.map(s=>(s.laborWarranty||0)+(s.equipmentWarranty||0))),J=()=>{o(3)},le=s=>{v(P===s?null:s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Make Your Decision"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review each bid side by side, ask clarifying questions, and choose your contractor."})]}),m.length>0&&e.jsx(Rt,{rebatePrograms:m,selectedIncentives:w,onToggleIncentive:y}),e.jsx("div",{className:"space-y-6",children:T.map(s=>{const N=g(s.bidId),p=N.filter(E=>E.is_answered).length,u=N.filter(E=>!E.is_answered),H=P===s.bidId,z=q.has(s.bidId),t=s.totalAmount===V,r=s.netCost===K,A=s.googleRating===ee&&s.googleRating>0,R=s.seer2===ne&&s.seer2>0,U=(s.laborWarranty||0)+(s.equipmentWarranty||0),L=U===oe&&U>0;return e.jsxs("div",{className:`
                relative bg-white rounded-xl overflow-hidden transition-all duration-200
                ${H?"ring-4 ring-switch-green-500 shadow-xl border-2 border-switch-green-500":"border-2 border-gray-200 shadow-md hover:shadow-lg hover:border-gray-300"}
              `,children:[e.jsx("div",{className:`
                absolute top-0 left-0 w-1.5 h-full
                ${H?"bg-switch-green-500":"bg-gradient-to-b from-switch-green-400 to-switch-green-600"}
              `}),e.jsxs("div",{className:"p-6 pl-8",children:[e.jsxs("div",{className:"flex items-start justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.contractor}),s.isSwitchPreferred&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-gradient-to-r from-switch-green-500 to-switch-green-600 text-white rounded-full text-xs font-medium",children:[e.jsx(De,{className:"w-3 h-3"})," Switch Preferred"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[H&&e.jsx("div",{className:"w-8 h-8 bg-switch-green-500 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-white"})}),e.jsx("button",{onClick:()=>le(s.bidId),className:`
                        py-2 px-4 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 text-sm
                        ${H?"bg-switch-green-600 text-white hover:bg-switch-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border border-gray-300"}
                      `,children:H?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4"}),"My Choice"]}):"Mark as My Choice"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-5 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-5 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-600 uppercase tracking-wide",children:"Total Price"}),t&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-switch-green-600 text-white text-xs font-semibold rounded-full",children:[e.jsx(F,{className:"w-3 h-3"})," LOWEST"]})]}),e.jsx("div",{className:`text-3xl font-bold ${t?"text-switch-green-700":"text-gray-900"}`,children:_(s.totalAmount)}),D>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Selected Rebates"}),e.jsxs("span",{className:"text-switch-green-600 font-semibold",children:["-",_(D)]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Net Cost"}),e.jsx("span",{className:`text-xl font-bold ${r?"text-switch-green-700":"text-gray-900"}`,children:_(s.netCost)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Be,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Equipment"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900",title:`${s.equipmentBrand} ${s.equipmentModel}`,children:s.equipmentBrand}),s.seer2&&e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsxs("span",{className:`text-xs ${R?"text-switch-green-700 font-bold":"text-gray-600"}`,children:["SEER2: ",s.seer2]}),R&&e.jsx(F,{className:"w-3 h-3 text-switch-green-600"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(F,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Rating"})]}),s.googleRating?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`text-sm font-bold ${A?"text-switch-green-700":"text-gray-900"}`,children:[s.googleRating.toFixed(1)," / 5",A&&e.jsx(F,{className:"w-3 h-3 inline ml-1 text-switch-green-600"})]}),s.reviewCount&&e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[s.reviewCount," reviews"]})]}):e.jsx("div",{className:"text-sm text-gray-400",children:"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(bt,{className:"w-4 h-4 text-switch-green-600"}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Warranty"})]}),s.laborWarranty||s.equipmentWarranty?e.jsxs("div",{className:"space-y-0.5",children:[s.laborWarranty&&e.jsxs("div",{className:`text-xs ${L?"text-switch-green-700 font-bold":"text-gray-900"}`,children:[s.laborWarranty,"yr labor"]}),s.equipmentWarranty&&e.jsxs("div",{className:`text-xs ${L?"text-switch-green-700 font-bold":"text-gray-900"}`,children:[s.equipmentWarranty,"yr equip"]}),L&&e.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-switch-green-600 text-white text-[10px] font-medium rounded mt-1",children:"BEST"})]}):e.jsx("div",{className:"text-sm text-gray-400",children:"N/A"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"bg-gray-100 px-5 py-3 flex items-center justify-between border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-bold text-gray-800",children:"Questions to Ask This Contractor"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-gray-500 bg-white px-2 py-1 rounded-full border",children:[p,"/",N.length," answered"]}),u.length>0&&e.jsx("button",{onClick:()=>h(s.bidId,s.contractor),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 bg-white hover:bg-gray-50 border border-gray-300 rounded-lg transition-colors",title:"Copy questions",children:c===s.bidId?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-4 h-4 text-switch-green-600"}),e.jsx("span",{className:"text-switch-green-600 font-medium",children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"w-4 h-4"}),e.jsx("span",{children:"Copy All"})]})})]})]}),e.jsx("div",{className:"p-4 flex-1 overflow-y-auto max-h-72",children:N.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"No questions for this bid."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:N.map(E=>e.jsxs("div",{className:`flex items-start gap-2 p-3 rounded-lg transition-colors ${E.is_answered?"bg-gray-50 opacity-60":"bg-white border border-gray-200 hover:border-gray-300"}`,children:[e.jsx("button",{onClick:()=>n(E),className:"flex-shrink-0 mt-0.5",children:E.is_answered?e.jsx(O,{className:"w-5 h-5 text-switch-green-600"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300 hover:border-switch-green-500 transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm ${E.is_answered?"text-gray-400 line-through":"text-gray-800"}`,children:E.question_text}),!E.is_answered&&e.jsx("div",{className:"flex items-center gap-1 mt-1.5",children:e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded border font-medium ${M(E.priority)}`,children:E.priority})})]})]},E.id))})})]})})]}),z&&e.jsx("div",{className:"mt-5 pt-5 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Contact Info"}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(yt,{className:"w-4 h-4 text-gray-400"}),s.phone]}),s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ht,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:`mailto:${s.email}`,className:"text-switch-green-600 hover:underline",children:s.email})]}),s.website&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(gt,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-switch-green-600 hover:underline truncate",children:s.website.replace(/^https?:\/\//,"")})]}),s.license&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"License:"})," ",s.license,s.licenseState&&` (${s.licenseState})`]}),s.insuranceVerified&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-switch-green-700",children:[e.jsx(O,{className:"w-4 h-4"})," Insurance Verified"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Timeline & Details"}),s.estimatedDays&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(fe,{className:"w-4 h-4 text-gray-400"}),"Est. ",s.estimatedDays," days to complete"]}),s.startDateAvailable&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-400"}),"Available: ",k(s.startDateAvailable)]}),s.validUntil&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"Quote valid until:"})," ",k(s.validUntil)]}),s.bidDate&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-gray-500",children:"Bid date:"})," ",k(s.bidDate)]}),s.financingOffered&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"text-switch-green-700 font-medium",children:"Financing Available"}),s.financingTerms&&e.jsxs("span",{className:"text-gray-500 ml-1",children:["- ",s.financingTerms]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Experience"}),s.yearsInBusiness&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.yearsInBusiness," years in business"]}),s.totalInstalls&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.totalInstalls.toLocaleString()," total installs"]}),s.certifications.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.certifications.map((E,Y)=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded",children:E},Y))}),s.extractionConfidence&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Extraction confidence: ",e.jsx("span",{className:"capitalize font-medium",children:s.extractionConfidence})]}),(s.valueScore||s.qualityScore||s.completenessScore)&&e.jsxs("div",{className:"flex items-center gap-2",children:[s.valueScore&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-switch-green-100 text-switch-green-700 rounded",children:["Value: ",s.valueScore]}),s.qualityScore&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-blue-100 text-blue-700 rounded",children:["Quality: ",s.qualityScore]})]})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsx("button",{onClick:()=>B(s.bidId),className:"flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors",children:z?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4"}),"Show Less"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4"}),"Show More Details"]})})})]})]},s.bidId)})}),i.length===0&&e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 p-12 text-center",children:[e.jsx(we,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Bids to Compare"}),e.jsx("p",{className:"text-gray-600",children:"Upload your contractor bids in the Gather phase to see them here."})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl border border-gray-200 p-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Note:"})," Marking a contractor as your choice is optional and for your reference only. You will work directly with your chosen contractor to finalize the installation."]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:J,className:"btn btn-primary flex items-center gap-2 px-6",children:["Continue",e.jsx(pe,{className:"w-4 h-4"})]})})]})}const Ie={pre_installation:{label:"Pre-Installation",description:"Verify these items before work begins"},equipment:{label:"Equipment Verification",description:"Confirm the right equipment was delivered and installed"},airflow:{label:"Airflow",description:"Proper airflow is critical for efficiency and comfort"},refrigerant:{label:"Refrigerant",description:"Correct refrigerant charge affects efficiency and equipment life"},electrical:{label:"Electrical",description:"Safe and proper electrical connections"},commissioning:{label:"Commissioning & Closeout",description:"Final steps to ensure everything is documented"}};function Mt(){const{projectId:i}=Q(),[a,l]=j.useState([]),[o,m]=j.useState(!0),[d,w]=j.useState("pre_installation");j.useEffect(()=>{i&&C()},[i]);async function C(){const{data:y}=await $.from("qii_checklist_items").select("*").order("display_order",{ascending:!0}),{data:x}=await $.from("project_qii_checklist").select("*").eq("project_id",i),_=new Map((x==null?void 0:x.map(n=>[n.checklist_item_id,n]))||[]),k=(y||[]).map(n=>({...n,status:_.get(n.id)}));l(k),m(!1)}async function P(y){var _;const x=((_=y.status)==null?void 0:_.is_verified)||!1;y.status?await $.from("project_qii_checklist").update({is_verified:!x,verified_at:x?null:new Date().toISOString(),verified_by:x?null:"homeowner"}).eq("id",y.status.id):await $.from("project_qii_checklist").insert({project_id:i,checklist_item_id:y.id,is_verified:!0,verified_at:new Date().toISOString(),verified_by:"homeowner"}),C()}function v(){const y=a.length,x=a.filter(n=>{var g;return(g=n.status)==null?void 0:g.is_verified}).length,_=a.filter(n=>n.is_critical),k=_.filter(n=>{var g;return(g=n.status)==null?void 0:g.is_verified}).length;return{total:y,verified:x,percentage:y>0?Math.round(x/y*100):0,critical:_.length,criticalVerified:k,criticalComplete:k===_.length}}function c(y){return a.filter(x=>x.category===y)}function S(y){const x=c(y),_=x.filter(k=>{var n;return(n=k.status)==null?void 0:n.is_verified}).length;return{total:x.length,verified:_}}function q(){window.print()}const f=v(),b=Object.keys(Ie);return o?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-switch-green-600 mx-auto mb-4"}),"Loading checklist..."]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Verify Your Installation"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Use this checklist to ensure your heat pump was installed correctly."})]}),e.jsxs("button",{onClick:q,className:"btn btn-secondary flex items-center gap-2 print:hidden",children:[e.jsx(ut,{className:"w-4 h-4"}),"Print"]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[f.verified,"/",f.total]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-switch-green-600 transition-all duration-300",style:{width:`${f.percentage}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[f.percentage,"% complete"]})]}),e.jsxs("div",{className:`rounded-lg p-4 ${f.criticalComplete?"bg-switch-green-50":"bg-amber-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f.criticalComplete?e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}):e.jsx(ot,{className:"w-5 h-5 text-amber-600"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Critical Items"})]}),e.jsxs("p",{className:`text-sm mt-1 ${f.criticalComplete?"text-switch-green-700":"text-amber-700"}`,children:[f.criticalVerified," of ",f.critical," critical items verified"]})]})]})}),e.jsx("div",{className:"space-y-3",children:b.map(y=>{const x=Ie[y],_=S(y),k=d===y,n=c(y),g=_.verified===_.total;return n.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsxs("button",{onClick:()=>w(k?null:y),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:x.label}),e.jsx("p",{className:"text-sm text-gray-500",children:x.description})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:`text-sm font-medium ${g?"text-switch-green-600":"text-gray-500"}`,children:[_.verified,"/",_.total]}),g&&e.jsx(X,{className:"w-5 h-5 text-switch-green-600"}),k?e.jsx(be,{className:"w-5 h-5 text-gray-400"}):e.jsx(ie,{className:"w-5 h-5 text-gray-400"})]})]}),k&&e.jsx("div",{className:"border-t border-gray-100 divide-y divide-gray-100",children:n.map(h=>{var M,B,D;return e.jsxs("div",{className:`px-4 py-3 flex items-start gap-3 ${(M=h.status)!=null&&M.is_verified?"bg-gray-50":""}`,children:[e.jsx("button",{onClick:()=>P(h),className:"flex-shrink-0 mt-0.5",children:(B=h.status)!=null&&B.is_verified?e.jsx(X,{className:"w-6 h-6 text-switch-green-600"}):e.jsx(ct,{className:"w-6 h-6 text-gray-300 hover:text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:`font-medium ${(D=h.status)!=null&&D.is_verified?"text-gray-500 line-through":"text-gray-900"}`,children:h.item_text}),h.is_critical&&e.jsx("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded-full",children:"Critical"})]}),h.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:h.description}),h.why_it_matters&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 text-sm text-blue-700 bg-blue-50 rounded-lg p-2",children:[e.jsx(xe,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Why it matters:"})," ",h.why_it_matters]})]})]})]},h.id)})})]},y)})}),f.percentage===100&&e.jsxs("div",{className:"bg-switch-green-50 border border-switch-green-200 rounded-xl p-6 text-center",children:[e.jsx(X,{className:"w-12 h-12 text-switch-green-600 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-bold text-switch-green-900",children:"Installation Verified!"}),e.jsx("p",{className:"text-switch-green-700 mt-1",children:"All quality installation items have been checked. Keep this checklist for your records."})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-5",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Tips for Using This Checklist"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"1."}),"Ask your contractor to walk through critical items with you before they leave"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"2."}),"Request documentation for items like load calculations and commissioning reports"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"3."}),"Take photos of equipment labels showing model numbers and serial numbers"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-switch-green-600",children:"4."}),"Do not sign off on the final payment until critical items are verified"]})]})]})]})}function Bt(){const{currentPhase:i,loading:a,error:l}=Q();if(a)return e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-switch-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading your project..."})]})});if(l)return e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[e.jsx("p",{className:"text-red-700",children:l}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary mt-4",children:"Retry"})]});switch(i){case 1:return e.jsx(Ce,{});case 2:return e.jsx(Dt,{});case 3:return e.jsx(Et,{});case 4:return e.jsx(Mt,{});default:return e.jsx(Ce,{})}}function Tt({user:i,projectId:a}){return e.jsx(At,{userId:i.id,initialProjectId:a,children:e.jsx($t,{children:e.jsx(Bt,{})})})}const ye="bidsmart_active_project";function Wt(){try{return localStorage.getItem(ye)}catch{return null}}function Pe(i){try{i?localStorage.setItem(ye,i):localStorage.removeItem(ye)}catch{}}function Lt(){const{user:i,loading:a,error:l}=st(),[o,m]=j.useState(null),[d,w]=j.useState(!0);j.useEffect(()=>{const v=Wt();v&&(m(v),w(!1))},[]);const C=v=>{m(v),Pe(v),w(!1)},P=v=>{m(v),Pe(v),w(!1)};return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-switch-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading BidSmart..."})]})}):l||!i?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl text-red-600",children:"!"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Unable to Load"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There was a problem connecting to the database. Please try refreshing the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Refresh Page"})]})}):d||!o?e.jsx(It,{user:i,onSelectProject:C,onCreateProject:P}):e.jsx(Tt,{user:i,projectId:o})}de.createRoot(document.getElementById("root")).render(e.jsx(Ue.StrictMode,{children:e.jsx(Lt,{})}));
//# sourceMappingURL=index-Cztq4PZO.js.map
